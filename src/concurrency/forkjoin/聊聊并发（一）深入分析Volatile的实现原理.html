<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0026)http://ifeve.com/volatile/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/ca-pub-9394337417063147.js"></script><script src="./聊聊并发（一）深入分析Volatile的实现原理_files/shares.php" charset="utf-8"></script><script src="./聊聊并发（一）深入分析Volatile的实现原理_files/id.php" charset="utf-8"></script>


<title>聊聊并发（一）深入分析Volatile的实现原理 | 并发编程网 - ifeve.com</title>
<meta name="description" content="让天下没有难学的技术">

<link rel="alternate" type="application/rss+xml" title="并发编程网 – ifeve.com RSS Feed" href="http://ifeve.com/feed/">
<link rel="alternate" type="application/atom+xml" title="并发编程网 – ifeve.com Atom Feed" href="http://ifeve.com/feed/atom/"> 
<link rel="pingback" href="http://ifeve.com/xmlrpc.php">

<link rel="stylesheet" href="./聊聊并发（一）深入分析Volatile的实现原理_files/style.css" type="text/css">
<link rel="stylesheet" href="./聊聊并发（一）深入分析Volatile的实现原理_files/comment-style.css" type="text/css">

 

<!-- All in One SEO Pack 2.2.7.1 by Michael Torbert of Semper Fi Web Design[258,315] -->
<meta name="description" itemprop="description" content="本文属于作者原创，原文发表于InfoQ：http://www.infoq.com/cn/articles/ftf-java-volatile 引言 在多线程并发编程中synchronized和Volatile都扮演着重要的角色，Volatile是轻量级的synchronized，它在多处理器开发中保证了共享变量的“">

<meta name="keywords" itemprop="keywords" content="cacheline,volatile">

<link rel="canonical" href="./聊聊并发（一）深入分析Volatile的实现原理_files/聊聊并发（一）深入分析Volatile的实现原理.html">
<!-- /all in one seo pack -->
<link rel="alternate" type="application/rss+xml" title="并发编程网 - ifeve.com » 聊聊并发（一）深入分析Volatile的实现原理评论Feed" href="http://ifeve.com/volatile/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/ifeve.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.5"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./聊聊并发（一）深入分析Volatile的实现原理_files/wp-emoji-release.min.js" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="yarppWidgetCss-css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/widget.css" type="text/css" media="all">
<link rel="stylesheet" id="dwqa-style-css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/style(1).css" type="text/css" media="all">
<link rel="stylesheet" id="wp-postratings-css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/postratings-css.css" type="text/css" media="all">
<link rel="stylesheet" id="display-authors-widget-styles-css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/display-authors-widget.css" type="text/css" media="all">
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/jquery.js"></script>
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/jquery-migrate.min.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://ifeve.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://ifeve.com/wp-includes/wlwmanifest.xml"> 
<link rel="next" title="聊聊并发（二）Java SE1.6中的Synchronized" href="http://ifeve.com/java-synchronized/">
<meta name="generator" content="WordPress 4.2.5">
<link rel="shortlink" href="http://ifeve.com/?p=1">


<!-- Plugin: Open external links a new window. Plugin by Kristian Risager Larsen, http://kristianrisagerlarsen.dk . Download it at http://wordpress.org/extend/plugins/open-external-links-in-a-new-window/ -->
<script type="text/javascript">//<![CDATA[
	function external_links_in_new_windows_loop() {
		if (!document.links) {
			document.links = document.getElementsByTagName('a');
		}
		var change_link = false;
		var force = '';
		var ignore = '';

		for (var t=0; t<document.links.length; t++) {
			var all_links = document.links[t];
			change_link = false;
			
			if(document.links[t].hasAttribute('onClick') == false) {
				// forced if the address starts with http (or also https), but does not link to the current domain
				if(all_links.href.search(/^http/) != -1 && all_links.href.search('ifeve.com') == -1) {
					// alert('Changeda '+all_links.href);
					change_link = true;
				}
					
				if(force != '' && all_links.href.search(force) != -1) {
					// forced
					// alert('force '+all_links.href);
					change_link = true;
				}
				
				if(ignore != '' && all_links.href.search(ignore) != -1) {
					// alert('ignore '+all_links.href);
					// ignored
					change_link = false;
				}

				if(change_link == true) {
					// alert('Changed '+all_links.href);
					document.links[t].setAttribute('onClick', 'javascript:window.open(\''+all_links.href+'\'); return false;');
					document.links[t].removeAttribute('target');
				}
			}
		}
	}
	
	// Load
	function external_links_in_new_windows_load(func)
	{	
		var oldonload = window.onload;
		if (typeof window.onload != 'function'){
			window.onload = func;
		} else {
			window.onload = function(){
				oldonload();
				func();
			}
		}
	}

	external_links_in_new_windows_load(external_links_in_new_windows_loop);
	//]]></script>


<!-- StarBox - the Author Box for Humans 3.0.4, visit: http://wordpress.org/plugins/starbox/ -->
<!-- /StarBox - the Author Box for Humans -->

<link rel="stylesheet" id="frontend.css-css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/frontend.css" type="text/css" media="all">
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/frontend.js"></script>
<link rel="stylesheet" id="hidedefault.css-css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/hidedefault.css" type="text/css" media="all">
<style type="text/css" media="screen">#wp-admin-bar-user-info .avatar-64 {width:64px}</style>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="stylesheet" type="text/css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/shCore.css"><link rel="stylesheet" type="text/css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/shThemeEclipse.css"><style type="text/css" id="syntaxhighlighteranchor"></style>

<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/jscript.js"></script>
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/comment.js"></script>
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/rollover.js"></script>

<!--[if IE 7]>
<link rel="stylesheet" href="http://ifeve.com/wp-content/themes/flat/ie7.css" type="text/css" />
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="http://ifeve.com/wp-content/themes/flat/ie8.css" type="text/css" />
<![endif]-->


<style type="text/css">
a, .post .title a:hover, .post_meta a:hover, #bread_crumb ul li a:hover, #previous_post a:hover, #next_post a:hover, .post a.more-link:hover, #right_col li a:hover, #copyright li a:hover, #archive_headline #keyword,
   #comments_wrapper a:hover, #comment_header_right .comment_switch_active a, #comment_header_right .comment_switch_active a:hover, #comment_pager .current
   { color:#00A19E; }

#no_post a.back:hover, #wp-calendar td a:hover, #wp-calendar #prev a:hover, #wp-calendar #next a:hover, .page_navi a:hover, #submit_comment:hover
 { background-color:#00A19E; }

#guest_info input:focus, #comment_textarea textarea:focus
 { border:1px solid #00A19E; }

a:hover
 { color:#BDC900; }

body { font-size:14px; }

#header { background:url(http://ifeve.com/wp-content/uploads/flat/bg.png) left top; }
.logo_text a { color:#F5F5F5; }
#site_description {  border-top:1px solid #BBBBBB; color:#D2D9CC; }


</style>

</head>

<body style="zoom: 1;"><link href="./聊聊并发（一）深入分析Volatile的实现原理_files/jiathis_counter.css" rel="stylesheet" type="text/css"><link href="./聊聊并发（一）深入分析Volatile的实现原理_files/jiathis_share.css" rel="stylesheet" type="text/css"><iframe frameborder="0" style="position: absolute; display: none; opacity: 0;"></iframe><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; top: 50%; left: 50%; overflow: auto;"></div><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; overflow: auto;"></div><iframe frameborder="0" src="./聊聊并发（一）深入分析Volatile的实现原理_files/jiathis_utility.html" style="display: none;"></iframe>

 <div id="header">
  <div class="header_menu">
    <ul id="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95" class="menu"><li id="menu-item-16594" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-16594"><a href="http://ifeve.com/">首页</a></li>
<li id="menu-item-3432" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3432"><a href="http://ifeve.com/wp-login.php">登录</a></li>
<li id="menu-item-17079" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-17079"><a href="http://ifeve.com/questions/">面试题</a></li>
<li id="menu-item-9219" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-9219"><a href="http://ifeve.com/category/java/">JAVA</a>
<ul class="sub-menu">
	<li id="menu-item-16108" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16108"><a href="http://ifeve.com/java-io/">Java IO 教程</a></li>
	<li id="menu-item-5283" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5283"><a href="http://ifeve.com/java-nio-all/">Java NIO 教程</a></li>
	<li id="menu-item-17514" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17514"><a href="http://ifeve.com/java-reflection/">JAVA Reflection教程</a></li>
	<li id="menu-item-16239" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16239"><a href="http://ifeve.com/java-network">Java 网络教程</a></li>
	<li id="menu-item-4416" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4416"><a href="http://ifeve.com/java-concurrency-thread-directory/">Java并发和多线程</a></li>
	<li id="menu-item-2767" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2767"><a href="http://ifeve.com/jmm-cookbook/">Java内存模型指南</a></li>
	<li id="menu-item-2747" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2747"><a href="http://ifeve.com/jmm-faq/">Java内存模型FAQ</a></li>
	<li id="menu-item-2765" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2765"><a href="http://ifeve.com/syn-jmm/">同步与Java内存模型</a></li>
	<li id="menu-item-5789" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5789"><a href="http://ifeve.com/oracle-java-concurrency-tutorial/">Oracle官方并发教程</a></li>
	<li id="menu-item-15316" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15316"><a href="http://ifeve.com/jvm-optimize/">JVM性能优化系列</a></li>
	<li id="menu-item-15313" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15313"><a href="http://ifeve.com/useful-jvm-flags/">JVM实用参数系列</a></li>
</ul>
</li>
<li id="menu-item-7938" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7938"><a href="http://ifeve.com/category/c/">C++</a></li>
<li id="menu-item-9220" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-9220"><a href="http://ifeve.com/category/framework/">Framework</a>
<ul class="sub-menu">
	<li id="menu-item-12798" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12798"><a href="http://ifeve.com/disruptor/">Disruptor 框架指南</a></li>
	<li id="menu-item-12783" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12783"><a title="Netty" href="http://ifeve.com/category/netty/">Netty</a></li>
	<li id="menu-item-12791" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12791"><a href="http://ifeve.com/category/scala/">Scala</a></li>
	<li id="menu-item-12312" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12312"><a href="http://ifeve.com/getting-started-with-stom-index/">Storm 入门</a></li>
	<li id="menu-item-9218" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9218"><a href="http://ifeve.com/google-guava/">Guava 官方指南</a></li>
	<li id="menu-item-20471" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20471"><a href="http://ifeve.com/velocity-guide/">Apache Velocity 官方指南</a></li>
	<li id="menu-item-21439" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21439"><a href="http://ifeve.com/storm-translation/">Apache Storm 官方文档</a></li>
</ul>
</li>
<li id="menu-item-555" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-555"><a href="http://ifeve.com/category/concurrency-translation/">其他译文</a>
<ul class="sub-menu">
	<li id="menu-item-2777" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2777"><a href="http://ifeve.com/java-concurrent/">并发基础</a></li>
	<li id="menu-item-3340" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3340"><a href="http://ifeve.com/aqs/">j.u.c同步框架</a></li>
	<li id="menu-item-2769" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2769"><a href="http://ifeve.com/fj/">Fork Join框架</a></li>
	<li id="menu-item-9221" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9221"><a href="http://ifeve.com/doug-lea/">Doug Lea 论文</a></li>
	<li id="menu-item-4643" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4643"><a href="http://ifeve.com/mechanical-sympathy/">Mechanical Sympathy</a></li>
	<li id="menu-item-6397" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6397"><a href="http://ifeve.com/stm/">软件事务内存导论</a></li>
	<li id="menu-item-10845" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10845"><a href="http://ifeve.com/jsr133-cn/">JSR133中文版</a></li>
</ul>
</li>
<li id="menu-item-103" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-103"><a href="http://ifeve.com/category/talk-concurrent/">本站原创</a>
<ul class="sub-menu">
	<li id="menu-item-2763" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2763"><a href="http://ifeve.com/talk-concurrency/">聊聊并发</a></li>
	<li id="menu-item-2753" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2753"><a href="http://ifeve.com/java-memory-model-0/">深入理解Java内存模型</a></li>
	<li id="menu-item-4862" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4862"><a href="http://ifeve.com/from-javaeye-sys-struct/">从Java视角理解系统结构</a></li>
	<li id="menu-item-4627" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4627"><a href="http://ifeve.com/ali-itu-agile/">阿里内贸团队敏捷实践</a></li>
</ul>
</li>
<li id="menu-item-7119" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-7119"><a href="http://ifeve.com/category/%e5%b9%b6%e5%8f%91%e4%b9%a6%e7%b1%8d/">并发书籍</a>
<ul class="sub-menu">
	<li id="menu-item-10846" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10846"><a href="http://ifeve.com/art-of-java-concurrent-program/">《Java 并发编程的艺术》迷你书</a></li>
	<li id="menu-item-6042" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6042"><a href="http://ifeve.com/perfbook/">《深入理解并行编程》</a></li>
	<li id="menu-item-9172" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9172"><a href="http://ifeve.com/c-plus-plus-concurrency-in-action/">《C++ 并发编程》</a></li>
	<li id="menu-item-7785" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7785"><a href="http://ifeve.com/java-7-concurrency-cookbook/">《Java 7 并发编程指南》</a></li>
	<li id="menu-item-7120" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7120"><a href="http://ifeve.com/jvm-concurrency">《Java 虚拟机并发编程》</a></li>
	<li id="menu-item-12360" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12360"><a href="http://ifeve.com/getting-started-with-stom-index/">《Storm入门》中文版</a></li>
</ul>
</li>
<li id="menu-item-9171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-9171"><a href="http://ifeve.com/need-you/">加入我们</a>
<ul class="sub-menu">
	<li id="menu-item-3246" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3246"><a href="http://ifeve.com/contribute/">我要投稿</a></li>
	<li id="menu-item-6854" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6854"><a href="http://ifeve.com/neitui/">内推阿里</a></li>
</ul>
</li>
<li id="menu-item-105" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-105"><a href="http://ifeve.com/about-site/">关于本站</a>
<ul class="sub-menu">
	<li id="menu-item-11306" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11306"><a href="http://ifeve.com/category/%e6%b4%bb%e5%8a%a8/">活动</a></li>
	<li id="menu-item-1487" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1487"><a href="http://ifeve.com/sitemap.html">文章归档</a></li>
	<li id="menu-item-131" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-131"><a href="http://ifeve.com/about-site/about-me/">关于清英</a></li>
	<li id="menu-item-7600" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7600"><a href="http://ifeve.com/ads/">广告合作</a></li>
</ul>
</li>
</ul>    </div>
  <!-- logo -->
  <h1 class="logo_text"><a href="http://ifeve.com/">并发编程网 - ifeve.com</a></h1>
<h2 id="site_description">让天下没有难学的技术</h2>
 </div>

 <div id="main_content" class="clearfix">

  <div id="left_col">
      <div id="bread_crumb">
    <ul class="clearfix">
     <li id="bc_home"><a href="http://ifeve.com/" title="首页">首页</a></li>
     <li id="bc_cat"><a href="http://ifeve.com/category/talk-concurrent/">本站原创</a></li>     <li class="last">聊聊并发（一）深入分析Volatile的实现原理</li>
    </ul>
   </div>
   
   
   <div class="post_wrap clearfix" id="single">
    <div class="post">
     <h3 class="title"><span>聊聊并发（一）深入分析Volatile的实现原理</span></h3>
     <div class="post_content">
      <p>本文属于作者原创，原文发表于InfoQ：<a href="http://www.infoq.com/cn/articles/ftf-java-volatile" target="_blank">http://www.infoq.com/cn/articles/ftf-java-volatile</a></p>
<h2><strong>引言</strong></h2>
<p>在多线程并发编程中synchronized和Volatile都扮演着重要的角色，Volatile是<strong>轻量级的synchronized</strong>，它在多处理器开发中保证了共享变量的“可见性”。可见性的意思是当一个线程修改一个共享变量时，另外一个线程能读到这个修改的值。它在某些情况下比synchronized的开销更小，本文将深入分析在硬件层面上Inter处理器是如何实现Volatile的，通过深入分析能帮助我们正确的使用Volatile变量。</p>
<p><span id="more-1"></span></p>
<h2><strong>术语定义</strong></h2>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="110">术语</td>
<td valign="top" width="155">英文单词</td>
<td valign="top" width="288">描述</td>
</tr>
<tr>
<td valign="top" width="110">共享变量</td>
<td valign="top" width="155"></td>
<td valign="top" width="288">在多个线程之间能够被共享的变量被称为共享变量。共享变量包括所有的实例变量，静态变量和数组元素。他们都被存放在堆内存中，Volatile只作用于共享变量。</td>
</tr>
<tr>
<td valign="top" width="110">内存屏障</td>
<td valign="top" width="155">Memory Barriers</td>
<td valign="top" width="288">是一组处理器指令，用于实现对内存操作的顺序限制。</td>
</tr>
<tr>
<td valign="top" width="110">缓冲行</td>
<td valign="top" width="155">Cache line</td>
<td valign="top" width="288">缓存中可以分配的最小存储单位。处理器填写缓存线时会加载整个缓存线，需要使用多个主内存读周期。</td>
</tr>
<tr>
<td valign="top" width="110">原子操作</td>
<td valign="top" width="155">Atomic operations</td>
<td valign="top" width="288">不可中断的一个或一系列操作。</td>
</tr>
<tr>
<td valign="top" width="110">缓存行填充</td>
<td valign="top" width="155">cache line fill</td>
<td valign="top" width="288">当处理器识别到从内存中读取操作数是可缓存的，处理器读取整个缓存行到适当的缓存（L1，L2，L3的或所有）</td>
</tr>
<tr>
<td valign="top" width="110">缓存命中</td>
<td valign="top" width="155">cache hit</td>
<td valign="top" width="288">如果进行高速缓存行填充操作的内存位置仍然是下次处理器访问的地址时，处理器从缓存中读取操作数，而不是从内存。</td>
</tr>
<tr>
<td valign="top" width="110">写命中</td>
<td valign="top" width="155">write hit</td>
<td valign="top" width="288">当处理器将操作数写回到一个内存缓存的区域时，它首先会检查这个缓存的内存地址是否在缓存行中，如果存在一个有效的缓存行，则处理器将这个操作数写回到缓存，而不是写回到内存，这个操作被称为写命中。</td>
</tr>
<tr>
<td valign="top" width="110">写缺失</td>
<td valign="top" width="155">write misses the cache</td>
<td valign="top" width="288">一个有效的缓存行被写入到不存在的内存区域。</td>
</tr>
</tbody>
</table>
<h2><strong>Volatile的官方定义</strong></h2>
<p>Java语言规范第三版中对volatile的定义如下： java编程语言允许线程访问共享变量，为了确保共享变量能被准确和一致的更新，线程应该确保通过排他锁单独获得这个变量。Java语言提供了volatile，在某些情况下比锁更加方便。如果一个字段被声明成volatile，java线程内存模型确保所有线程看到这个变量的值是一致的。</p>
<h2><strong>为什么要使用Volatile</strong></h2>
<p>Volatile变量修饰符如果使用<strong>恰当</strong>的话，它比synchronized的<strong>使用和执行成本会更低</strong>，因为它不会引起线程上下文的切换和调度。</p>
<h2><strong>Volatile的实现原理</strong></h2>
<p>那么Volatile是如何来保证可见性的呢？在x86处理器下通过工具获取JIT编译器生成的汇编指令来看看对Volatile进行写操作CPU会做什么事情。</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="90">Java代码：</td>
<td valign="top" width="463">instance = new Singleton();//instance是volatile变量</td>
</tr>
<tr>
<td valign="top" width="90">汇编代码：</td>
<td valign="top" width="463">0x01a3de1d: movb $0x0,0x1104800(%esi);0x01a3de24:&nbsp;<strong>lock</strong>&nbsp;addl $0x0,(%esp);</td>
</tr>
</tbody>
</table>
<p>有volatile变量修饰的共享变量进行写操作的时候会多第二行汇编代码，通过查IA-32架构软件开发者手册可知，lock前缀的指令在多核处理器下会引发了两件事情。</p>
<ul>
<li>将当前处理器缓存行的数据会写回到系统内存。</li>
<li>这个写回内存的操作会引起在其他CPU里缓存了该内存地址的数据无效。</li>
</ul>
<p>处理器为了提高处理速度，不直接和内存进行通讯，而是先将系统内存的数据读到内部缓存（L1,L2或其他）后再进行操作，但操作完之后不知道何时会写到内存，如果对声明了Volatile变量进行写操作，JVM就会向处理器发送一条Lock前缀的指令，将这个变量所在缓存行的数据写回到系统内存。但是就算写回到内存，如果其他处理器缓存的值还是旧的，再执行计算操作就会有问题，所以在多处理器下，为了保证各个处理器的缓存是一致的，就会实现缓存一致性协议，每个处理器通过嗅探在总线上传播的数据来检查自己缓存的值是不是过期了，当处理器发现自己缓存行对应的内存地址被修改，就会将当前处理器的缓存行设置成无效状态，当处理器要对这个数据进行修改操作的时候，会强制重新从系统内存里把数据读到处理器缓存里。</p>
<p>这两件事情在IA-32软件开发者架构手册的第三册的多处理器管理章节（第八章）中有详细阐述。</p>
<p><strong>Lock前缀指令会引起处理器缓存回写到内存</strong>。Lock前缀指令导致在执行指令期间，声言处理器的 LOCK# 信号。在多处理器环境中，LOCK# 信号确保在声言该信号期间，处理器可以独占使用任何共享内存。（因为它会锁住总线，导致其他CPU不能访问总线，不能访问总线就意味着不能访问系统内存），但是在最近的处理器里，LOCK＃信号一般不锁总线，而是锁缓存，毕竟锁总线开销比较大。在8.1.4章节有详细说明锁定操作对处理器缓存的影响，对于Intel486和Pentium处理器，在锁操作时，总是在总线上声言LOCK#信号。但在P6和最近的处理器中，如果访问的内存区域已经缓存在处理器内部，则不会声言LOCK#信号。相反地，它会锁定这块内存区域的缓存并回写到内存，并使用缓存一致性机制来确保修改的原子性，此操作被称为“缓存锁定”，<strong>缓存一致性机制会阻止同时修改被两个以上处理器缓存的内存区域数据</strong>。</p>
<p><strong>一个处理器的缓存回写到内存会导致其他处理器的缓存无效</strong>。IA-32处理器和Intel 64处理器使用MESI（修改，独占，共享，无效）控制协议去维护内部缓存和其他处理器缓存的一致性。在多核处理器系统中进行操作的时候，IA-32 和Intel 64处理器能嗅探其他处理器访问系统内存和它们的内部缓存。它们使用嗅探技术保证它的内部缓存，系统内存和其他处理器的缓存的数据在总线上保持一致。例如在Pentium和P6 family处理器中，如果通过嗅探一个处理器来检测其他处理器打算写内存地址，而这个地址当前处理共享状态，那么正在嗅探的处理器将无效它的缓存行，在下次访问相同内存地址时，强制执行缓存行填充。</p>
<h2><strong>Volatile的使用优化</strong></h2>
<p>著名的Java并发编程大师Doug lea在JDK7的并发包里新增一个队列集合类LinkedTransferQueue，他在使用Volatile变量时，用一种追加字节的方式来优化队列出队和入队的性能。</p>
<p><strong>追加字节能优化性能</strong>？这种方式看起来很神奇，但如果深入理解处理器架构就能理解其中的奥秘。让我们先来看看LinkedTransferQueue这个类，它使用一个内部类类型来定义队列的头队列（Head）和尾节点（tail），而这个内部类PaddedAtomicReference相对于父类AtomicReference只做了一件事情，就将共享变量追加到64字节。我们可以来计算下，一个对象的引用占4个字节，它追加了15个变量共占60个字节，再加上父类的Value变量，一共64个字节。</p>
<pre class="brush: java; title: ; notranslate" title="">/** head of the queue */
private transient final PaddedAtomicReference&lt;QNode&gt; head;

/** tail of the queue */
private transient final PaddedAtomicReference&lt;QNode&gt; tail;

static final class PaddedAtomicReference &lt;T&gt; extends AtomicReference &lt;T&gt; {

  // enough padding for 64bytes with 4byte refs
  Object p0, p1, p2, p3, p4, p5, p6, p7, p8, p9, pa, pb, pc, pd, pe;

  PaddedAtomicReference(T r) {

    super(r);

  }

}

public class AtomicReference &lt;V&gt; implements java.io.Serializable {

  private volatile V value;

  //省略其他代码

｝
</pre>
<p><strong>为什么追加64字节能够提高并发编程的效率呢</strong>？ 因为对于英特尔酷睿i7，酷睿， Atom和NetBurst， Core Solo和Pentium M处理器的L1，L2或L3缓存的高速缓存行是64个字节宽，不支持部分填充缓存行，这意味着如果队列的头节点和尾节点都不足64字节的话，处理器会将它们都读到同一个高速缓存行中，在多处理器下每个处理器都会缓存同样的头尾节点，当一个处理器试图修改头接点时会将整个缓存行锁定，那么在缓存一致性机制的作用下，会导致其他处理器不能访问自己高速缓存中的尾节点，而队列的入队和出队操作是需要不停修改头接点和尾节点，所以在多处理器的情况下将会严重影响到队列的入队和出队效率。Doug lea使用追加到64字节的方式来填满高速缓冲区的缓存行，避免头接点和尾节点加载到同一个缓存行，使得头尾节点在修改时不会互相锁定。</p>
<p>那么是不是在使用Volatile变量时都应该追加到64字节呢？不是的。在两种场景下不应该使用这种方式。第一：<strong>缓存行非64字节宽的处理器</strong>，如P6系列和奔腾处理器，它们的L1和L2高速缓存行是32个字节宽。第二：<strong>共享变量不会被频繁的写</strong>。因为使用追加字节的方式需要处理器读取更多的字节到高速缓冲区，这本身就会带来一定的性能消耗，共享变量如果不被频繁写的话，锁的几率也非常小，就没必要通过追加字节的方式来避免相互锁定。</p>
<h2><strong>参考资料</strong></h2>
<ul>
<li><a href="http://www.infoq.com/cn/articles/zzm-java-hsdis-jvm">JVM执行篇：使用HSDIS插件分析JVM代码执行细节</a></li>
<li><a href="http://www.infoq.com/cn/articles/memory_barriers_jvm_concurrency">内存屏障和并发</a></li>
<li><a href="http://www.intel.com/products/processor/manuals/">Intel 64和IA-32架构软件开发人员手册</a></li>
</ul>
<div style="margin-top: 15px; font-style: italic">
<p><strong>原创文章，转载请注明：</strong> 转载自<a href="http://ifeve.com/">并发编程网 – ifeve.com</a></p>
<p><strong>本文链接地址:</strong> <a href="./聊聊并发（一）深入分析Volatile的实现原理_files/聊聊并发（一）深入分析Volatile的实现原理.html">聊聊并发（一）深入分析Volatile的实现原理</a></p>
</div>
<p style="margin-top: 0; margin-bottom: 15px; color: #888888; font-size: 80%; font-style: italic">文章的脚注信息由WordPress的<a href="http://easwy.com/blog/wordpress/wp-posturl/" style="color: #8888FF; text-decoration: underline;">wp-posturl插件</a>自动生成</p>
<div style="clear:both; margin-top:5px; margin-bottom:5px;"></div><div style="float:left"><!-- JiaThis Button BEGIN -->
<div id="jiathis_style_32x32">
	<a class="jiathis_button_qzone" title="分享到QQ空间"><span class="jiathis_txt jtico jtico_qzone"></span></a>
	<a class="jiathis_button_tsina" title="分享到新浪微博"><span class="jiathis_txt jtico jtico_tsina"></span></a>
	<a class="jiathis_button_tqq" title="分享到腾讯微博"><span class="jiathis_txt jtico jtico_tqq"></span></a>
	<a class="jiathis_button_renren" title="分享到人人网"><span class="jiathis_txt jtico jtico_renren"></span></a>
	<a class="jiathis_button_kaixin001" title="分享到开心网"><span class="jiathis_txt jtico jtico_kaixin001"></span></a>
	<a href="http://www.jiathis.com/share/" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"><span class="jiathis_button_expanded jiathis_counter jiathis_bubble_style" id="jiathis_counter_69" title="累计分享4次">4</span></a>
</div>
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/jia.js" charset="utf-8"></script><script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/plugin.client.js" charset="utf-8"></script>
<!-- JiaThis Button END --></div><div style="clear:both; margin-top:5px; margin-bottom:5px;"></div>
                         <div class="abh_box abh_box_down abh_box_business"><ul class="abh_tabs"> <li class="abh_about abh_active"><a href="http://ifeve.com/volatile/#abh_about">About</a></li> <li class="abh_posts"><a href="http://ifeve.com/volatile/#abh_posts">Latest Posts</a></li></ul><div class="abh_tab_content"><section class="vcard abh_about_tab abh_tab" style="display:block"><div class="abh_image"><a href="http://weibo.com/kirals" class="url" target="_blank" title="方 腾飞"><img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></a></div><div class="abh_social"> </div><div class="abh_text"><h3 class="fn name"><a href="http://weibo.com/kirals" class="url" target="_blank">方 腾飞</a></h3><div class="abh_job"></div><div class="description note abh_description">花名清英，并发网创始人，蚂蚁金服技术专家。目前工作于支付宝微贷事业部，关注互联网金融，并发编程和敏捷实践。</div></div> </section><section class="abh_posts_tab abh_tab"><div class="abh_image"><a href="http://weibo.com/kirals" class="url" target="_blank" title="方 腾飞"><img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></a></div><div class="abh_social"> </div><div class="abh_text"><h4>Latest posts by 方 腾飞 <span class="abh_allposts">(<a href="http://ifeve.com/author/admin/">see all</a>)</span></h4><div class="abh_description note"><ul>				<li>					<a href="http://ifeve.com/ali-think-12/">阿里感悟（十一）如何准备面试</a><span> - 2015 年 10 月 6 日</span>				</li>				<li>					<a href="http://ifeve.com/think-in-ali-10/">阿里感悟（十）如何写好简历</a><span> - 2015 年 10 月 6 日</span>				</li>				<li>					<a href="http://ifeve.com/zookeeper-apache/">《ZooKeeper官方指南》翻译邀请</a><span> - 2015 年 10 月 5 日</span>				</li></ul></div></div> </section></div> </div><div class="yarpp-related">
<h3>Related posts:</h3><ol>
<li><a href="http://ifeve.com/concurrentlinkedqueue/" rel="bookmark" title="聊聊并发（六）ConcurrentLinkedQueue的实现原理分析">聊聊并发（六）ConcurrentLinkedQueue的实现原理分析 </a></li>
<li><a href="http://ifeve.com/atomic-operation/" rel="bookmark" title="聊聊并发（五）原子操作的实现原理">聊聊并发（五）原子操作的实现原理 </a></li>
<li><a href="http://ifeve.com/java-blocking-queue/" rel="bookmark" title="聊聊并发（七）——Java中的阻塞队列">聊聊并发（七）——Java中的阻塞队列 </a></li>
<li><a href="http://ifeve.com/java-copy-on-write/" rel="bookmark" title="聊聊并发-Java中的Copy-On-Write容器">聊聊并发-Java中的Copy-On-Write容器 </a></li>
<li><a href="http://ifeve.com/concurrenthashmap/" rel="bookmark" title="聊聊并发（四）深入分析ConcurrentHashMap">聊聊并发（四）深入分析ConcurrentHashMap </a></li>
<li><a href="http://ifeve.com/talk-concurrency-forkjoin/" rel="bookmark" title="聊聊并发（八）——Fork/Join框架介绍">聊聊并发（八）——Fork/Join框架介绍 </a></li>
<li><a href="http://ifeve.com/producers-and-consumers-mode/" rel="bookmark" title="聊聊并发（十）生产者消费者模式">聊聊并发（十）生产者消费者模式 </a></li>
<li><a href="http://ifeve.com/java-threadpool/" rel="bookmark" title="聊聊并发（三）Java线程池的分析和使用">聊聊并发（三）Java线程池的分析和使用 </a></li>
<li><a href="http://ifeve.com/java-synchronized/" rel="bookmark" title="聊聊并发（二）Java SE1.6中的Synchronized">聊聊并发（二）Java SE1.6中的Synchronized </a></li>
<li><a href="http://ifeve.com/disruptor-cacheline-padding/" rel="bookmark" title="剖析Disruptor:为什么会这么快？（二）神奇的缓存行填充">剖析Disruptor:为什么会这么快？（二）神奇的缓存行填充 </a></li>
<li><a href="http://ifeve.com/disruptor-padding/" rel="bookmark" title="Dissecting the Disruptor: Why it’s so fast (part two) – Magic cache line padding">Dissecting the Disruptor: Why it’s so fast (part two) – Magic cache line padding </a></li>
<li><a href="http://ifeve.com/java_lock_see2/" rel="bookmark" title="Java锁的种类以及辨析（二）：自旋锁的其他种类">Java锁的种类以及辨析（二）：自旋锁的其他种类 </a></li>
<li><a href="http://ifeve.com/write-combining/" rel="bookmark" title="Write Combining">Write Combining </a></li>
<li><a href="http://ifeve.com/juc-linkedblockingqueue/" rel="bookmark" title="JUC LinkedBlockingQueue">JUC LinkedBlockingQueue </a></li>
<li><a href="http://ifeve.com/copyonwritearraylist-set/" rel="bookmark" title="CopyOnWriteArrayList类set方法疑惑？">CopyOnWriteArrayList类set方法疑惑？ </a></li>
</ol>
</div>
           </div><!-- END .post_content -->
    </div>
    <div class="meta">
          <ul>
      <li class="post_date clearfix">
       <span class="date">20</span>
       <span class="month">Aug</span>
       <span class="year">2012</span>
      </li>
      
<li class="post_comment">
16,882 人阅读</li>

      <li class="post_author"><a href="http://ifeve.com/author/admin/" title="由方 腾飞发布" rel="author">方 腾飞</a></li>      <li class="post_category"><a href="http://ifeve.com/category/talk-concurrent/" rel="category tag">本站原创</a></li>       <li class="post_category"><div id="post-ratings-1" class="post-ratings" itemscope="" itemtype="http://schema.org/Article" data-nonce="80aa129880"><img id="rating_1_1" src="./聊聊并发（一）深入分析Volatile的实现原理_files/rating_on.gif" alt="好烂啊" title="好烂啊" onmouseover="current_rating(1, 1, &#39;好烂啊&#39;);" onmouseout="ratings_off(4, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1_2" src="./聊聊并发（一）深入分析Volatile的实现原理_files/rating_on.gif" alt="没价值" title="没价值" onmouseover="current_rating(1, 2, &#39;没价值&#39;);" onmouseout="ratings_off(4, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1_3" src="./聊聊并发（一）深入分析Volatile的实现原理_files/rating_on.gif" alt="凑合看看" title="凑合看看" onmouseover="current_rating(1, 3, &#39;凑合看看&#39;);" onmouseout="ratings_off(4, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1_4" src="./聊聊并发（一）深入分析Volatile的实现原理_files/rating_on.gif" alt="还不错" title="还不错" onmouseover="current_rating(1, 4, &#39;还不错&#39;);" onmouseout="ratings_off(4, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1_5" src="./聊聊并发（一）深入分析Volatile的实现原理_files/rating_off.gif" alt="超赞" title="超赞" onmouseover="current_rating(1, 5, &#39;超赞&#39;);" onmouseout="ratings_off(4, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"> (<strong>4</strong> votes, average: <strong>4.00</strong> out of 5)<br><span class="post-ratings-text" id="ratings_1_text"></span><meta itemprop="headline" content="聊聊并发（一）深入分析Volatile的实现原理"><meta itemprop="description" content="本文属于作者原创，原文发表于InfoQ：http://www.infoq.com/cn/articles/ftf-java-volatile
引言
在多线程并发编程中synchronized和Volatile都扮演着重要的角色，Volatile是轻量级的synchronized，它在多处理器开发中保证了共享变量的“可见性”。可见性的意思是当一个线程修改一个共享变量时，另外一个线程能读到这个修改..."><meta itemprop="datePublished" content="2012-08-20T09:22:00+00:00"><meta itemprop="url" content="http://ifeve.com/volatile/"><div style="display: none;" itemprop="aggregateRating" itemscope="" itemtype="http://schema.org/AggregateRating"><meta itemprop="bestRating" content="5"><meta itemprop="worstRating" content="1"><meta itemprop="ratingValue" content="4"><meta itemprop="ratingCount" content="4"></div></div><div id="post-ratings-1-loading" class="post-ratings-loading">
			<img src="./聊聊并发（一）深入分析Volatile的实现原理_files/loading.gif" width="16" height="16" alt="Loading..." title="Loading..." class="post-ratings-image">Loading...</div></li>       <li class="post_comment"><a href="http://ifeve.com/volatile/#comments">20 条评论</a></li>           </ul>
         </div>
   </div><!-- END .post_wrap -->

   
      <div id="comments_wrapper">
    




<div id="comment_header" class="clearfix">

 <ul id="comment_header_left">
  <li id="add_comment"><a href="http://ifeve.com/volatile/#respond">发表评论</a></li>
  <li id="comment_feed"><a href="http://ifeve.com/comments/feed/" title="RSS订阅评论">RSS订阅评论</a></li>
 </ul>

 <ul id="comment_header_right">
   <li id="trackback_switch"><a href="javascript:void(0);">Trackback ( 1 )</a></li>
   <li id="comment_switch" class="comment_switch_active"><a href="javascript:void(0);">评论 ( 20 )</a></li>
 </ul>



</div><!-- END #comment_header -->

<div id="comments">

 <div id="comment_area">
  <!-- start commnet -->
  <ol class="commentlist">
	
 <li class="comment guest-comment" id="comment-149">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/f23a5c5b2533079845bca2dae85997c3" srcset="http://gravatar0.233.wiki/avatar/f23a5c5b2533079845bca2dae85997c3?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-149">

BlueIceQ
</span>
     </li>
     <li class="comment-date">2013/01/27 11:22上午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-149&#39;, &#39;comment-149&#39;, &#39;comment-content-149&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-149">
    <p>有些地方不太明白，上文提到：“队列的头节点和尾节点都不足64字节的话，处理器会将它们都读到同一个高速缓存行中”，这里是不是要有一个前提，就是头节点和尾节点的字节数之和也不超过64字节，因为一个缓存行的大小就是64字节，超过了一个缓存行的大小了。</p>
  </div>

<ul class="children">

 <li class="comment admin-comment" id="comment-153">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc(1)" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-153" class="url admin-url" href="http://ifeve.com/" rel="external nofollow">

方 腾飞
</a>
     </li>
     <li class="comment-date">2013/01/27 11:33下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-153&#39;, &#39;comment-153&#39;, &#39;comment-content-153&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-153">
    <p>头节点和尾节点的字节数肯定不超过64的。一个对象的引用占4个字节，头＋尾节电才占8字节。</p>
  </div>

<ul class="children">

 <li class="comment guest-comment" id="comment-3277">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/cf4ad0610b6108c8481b068c344268f3" srcset="http://gravatar0.233.wiki/avatar/cf4ad0610b6108c8481b068c344268f3?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-3277">

surest
</span>
     </li>
     <li class="comment-date">2013/10/17 1:53下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-3277&#39;, &#39;comment-3277&#39;, &#39;comment-content-3277&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-3277">
    <p>上文提到“一个对象的引用占4个字节，它追加了15个变量共占60个字节，再加上父类的Value变量，一共64个字节”，但在HotSpot VM中每个对象的对象头占用8byte，这样算来一个PaddedAtomicReference对象占用了70byte的大小，超过了64byte的cache line大小；这样是否会导致 head 和 tail 共享 cahce line？</p>
  </div>

<ul class="children">

 <li class="comment guest-comment" id="comment-3664">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/saved_resource" srcset="http://gravatar0.233.wiki/avatar/?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo avatar-default" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-3664">

anonymous
</span>
     </li>
     <li class="comment-date">2013/10/30 4:57下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-3664&#39;, &#39;comment-3664&#39;, &#39;comment-content-3664&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-3664">
    <p>这里的head和tail其实是头和尾的索引位置</p>
  </div>

</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-306">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/saved_resource" srcset="http://gravatar0.233.wiki/avatar/?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo avatar-default" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-306">

Tuscany
</span>
     </li>
     <li class="comment-date">2013/02/22 4:35下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-306&#39;, &#39;comment-306&#39;, &#39;comment-content-306&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-306">
    <p>著名的Java并发编程大师Doug lea在JDK7的并发包里新增一个队列集合类LinkedTransferQueue，他在使用Volatile变量时，用一种追加字节的方式来优化队列出队和入队的性能。</p>
<p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
文中的jdk7是指哪个版本？<br>
我机器上jdk1.7.0_15 x86_64并没有看到文中所说的 PaddedAtomicReference</p>
  </div>

<ul class="children">

 <li class="comment admin-comment" id="comment-308">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc(1)" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-308" class="url admin-url" href="http://ifeve.com/" rel="external nofollow">

方 腾飞
</a>
     </li>
     <li class="comment-date">2013/02/22 4:38下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-308&#39;, &#39;comment-308&#39;, &#39;comment-content-308&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-308">
    <p>未公开的版本，现在的版本应该已经去掉了。因为Java7做了优化。</p>
  </div>

<ul class="children">

 <li class="comment guest-comment" id="comment-310">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/saved_resource(1)" srcset="http://gravatar0.233.wiki/avatar/?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo avatar-default" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-310">

Tuscany
</span>
     </li>
     <li class="comment-date">2013/02/22 4:45下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-310&#39;, &#39;comment-310&#39;, &#39;comment-content-310&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-310">
    <p>做了哪些优化呢？<br>
除了cache line padding之外还有哪些方法能解决false sharing？</p>
<p>多谢！</p>
  </div>

<ul class="children">

 <li class="comment admin-comment" id="comment-312">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc(1)" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-312" class="url admin-url" href="http://ifeve.com/" rel="external nofollow">

方 腾飞
</a>
     </li>
     <li class="comment-date">2013/02/22 5:01下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-312&#39;, &#39;comment-312&#39;, &#39;comment-content-312&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-312">
    <p>见 <a href="http://ifeve.com/false-shareing-java-7-cn/" rel="nofollow">http://ifeve.com/false-shareing-java-7-cn/</a></p>
  </div>

<ul class="children">

 <li class="comment guest-comment" id="comment-314">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/saved_resource" srcset="http://gravatar1.233.wiki/avatar/?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo avatar-default" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-314">

Tuscany
</span>
     </li>
     <li class="comment-date">2013/02/22 5:10下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-314&#39;, &#39;comment-314&#39;, &#39;comment-content-314&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-314">
    <p>这里面说JDK7会有优化掉代码中没有使用的代码，所以呢自己加的padding部分就被“优化”掉了，不能达到cache line padding的目的，所以需要再加个“无用”的方法以免cache line padding部分被优化掉。</p>
<p>那也就是说jdk7的优化是针对无用代码的，而不是针对cache line padding的。</p>
  </div>

</li><!-- #comment-## -->

 <li class="comment admin-comment" id="comment-316">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc(1)" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-316" class="url admin-url" href="http://ifeve.com/" rel="external nofollow">

方 腾飞
</a>
     </li>
     <li class="comment-date">2013/02/22 5:12下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-316&#39;, &#39;comment-316&#39;, &#39;comment-content-316&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-316">
    <p>是的。</p>
  </div>

</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-928">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/bbb1d5c6f8ce7d3619bef549dbc6008c" srcset="http://gravatar1.233.wiki/avatar/bbb1d5c6f8ce7d3619bef549dbc6008c?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-928" class="url guest-url" href="http://whutec.sinaapp.com/" rel="external nofollow">

逍遥K杰
</a>
     </li>
     <li class="comment-date">2013/04/14 2:25下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-928&#39;, &#39;comment-928&#39;, &#39;comment-content-928&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-928">
    <p>Volatile在多线程下不能保证变量的原子性，并且会产生脏数据，那么能线程间共享又有啥意义呢</p>
  </div>

<ul class="children">

 <li class="comment admin-comment" id="comment-931">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc(1)" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-931" class="url admin-url" href="http://weibo.com/kirals" rel="external nofollow">

方 腾飞
</a>
     </li>
     <li class="comment-date">2013/04/14 11:08下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-931&#39;, &#39;comment-931&#39;, &#39;comment-content-931&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-931">
    <p>结合CAS算法一起使用可以保证原子性。</p>
  </div>

</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-1010">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/0622439085c3dd568dab23652ee8fd74" srcset="http://gravatar0.233.wiki/avatar/0622439085c3dd568dab23652ee8fd74?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-1010">

sun shanghai
</span>
     </li>
     <li class="comment-date">2013/04/26 10:56上午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-1010&#39;, &#39;comment-1010&#39;, &#39;comment-content-1010&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-1010">
    <p>请教一个问题， 似乎不用volatile也能及时的获得变量被更新后的值呢。 我测试是这样的， 不大理解，特请教。</p>
<p>import java.lang.*;<br>
/**<br>
 * 我觉得如果不加volatile修饰符，则第1个线程是永远不会停止的，<br>
 * 但是实际上线程2把flag设置为true后，线程1就停止了<br>
 * 这个是什么原因呢？不明白。<br>
 */<br>
public class Counter {<br>
	//<br>
	private static Boolean flag = new Boolean(false);</p>
<p>	// private volatile static Boolean flag = new Boolean(false);</p>
<p>	public static void main(String[] args) {</p>
<p>		// 线程1<br>
		new Thread() {<br>
			int i = 0;</p>
<p>			public void run() {<br>
				while (!flag.booleanValue()) {<br>
					System.out.println(i++);<br>
				}<br>
			}<br>
		}.start();</p>
<p>		// 线程2<br>
		new Thread() {<br>
			public void run() {<br>
				try {<br>
					Thread.sleep(1000);<br>
					flag = new Boolean(true);<br>
				} catch (InterruptedException e) {<br>
					e.printStackTrace();<br>
				}<br>
			}<br>
		}.start();<br>
	}<br>
}</p>
  </div>

<ul class="children">

 <li class="comment guest-comment" id="comment-1034">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/100" class="avatar avatar-35" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-1034" class="url guest-url" href="http://www.ticmy.com/" rel="external nofollow">

丁 一
</a>
     </li>
     <li class="comment-date">2013/04/28 9:55下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-1034&#39;, &#39;comment-1034&#39;, &#39;comment-content-1034&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-1034">
    <p>可见性的具体实例可参见这篇：<a href="http://ifeve.com/concurrency-visibility/" target="_blank" rel="nofollow">http://ifeve.com/concurrency-visibility/</a></p>
  </div>

</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-8278">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/ef19460588eaa6a2329f069a8d9fe0f7" srcset="http://gravatar1.233.wiki/avatar/ef19460588eaa6a2329f069a8d9fe0f7?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-8278">

G
</span>
     </li>
     <li class="comment-date">2014/03/31 11:36上午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-8278&#39;, &#39;comment-8278&#39;, &#39;comment-content-8278&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-8278">
    <p>volatile在编译器的实现上是否分为强弱两种方式，一种是明确变量是内存变量而不是寄存器变量；另外一种则表明是强制的内存变量每次都要从内存中读取不允许使用缓存。<br>
而c语言中（centos gcc）下的volatile变量的操作则不会带有lock前缀，不知道这个情况和文中所说是否矛盾？</p>
  </div>

</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-21565">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/saved_resource(1)" srcset="http://gravatar0.233.wiki/avatar/?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo avatar-default" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-21565">

匿名
</span>
     </li>
     <li class="comment-date">2014/07/01 6:00下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-21565&#39;, &#39;comment-21565&#39;, &#39;comment-content-21565&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-21565">
    <p>请教个问题，看了两篇关于伪共享的文章，这篇中提到的是填补15个引用类型已达到4*15 + 1*4 = 64目的，另外一篇文章中http://ifeve.com/false-shareing-java-7-cn/使用的确是6个long类型来进行填充，理由是每个对象都有一个对象头。请问这两种方式哪种是正确的还是说有适用范围的？</p>
  </div>

</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-25271">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/5ac083cc48a32509f4294dd50919d6e7" srcset="http://gravatar1.233.wiki/avatar/5ac083cc48a32509f4294dd50919d6e7?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-25271">

sunny
</span>
     </li>
     <li class="comment-date">2014/09/22 5:01下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-25271&#39;, &#39;comment-25271&#39;, &#39;comment-content-25271&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-25271">
    <p>我觉得value的2头是不是都需要Padding?否则还是可能被伪共享？</p>
<p>例如<br>
 Object p0, p1, p2, p3, p4, p5, p6, p7, p8, p9, pa, pb, pc, pd, pe;<br>
volatile v;<br>
 Object p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p1a, p1b, p1c, p1d, p1e;</p>
  </div>

</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-25537">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/363bf7e2a7465040b1e9ba4409109c96" srcset="http://gravatar0.233.wiki/avatar/363bf7e2a7465040b1e9ba4409109c96?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-25537">

yangzihao
</span>
     </li>
     <li class="comment-date">2014/10/08 8:19下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-25537&#39;, &#39;comment-25537&#39;, &#39;comment-content-25537&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-25537">
    <p>请问作者，synchronized和锁之间的关系解释的很模糊啊</p>
  </div>

<ul class="children">

 <li class="comment guest-comment" id="comment-25538">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/a21e2b8f4893347e62eeca7597f04ebc(1)" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-25538" class="url guest-url" href="http://weibo.com/kirals" rel="external nofollow">

方 腾飞
</a>
     </li>
     <li class="comment-date">2014/10/08 8:23下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-25538&#39;, &#39;comment-25538&#39;, &#39;comment-content-25538&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-25538">
    <p>看下这篇文章能否回答你的问题 <a href="http://ifeve.com/java-synchronized/" rel="nofollow">http://ifeve.com/java-synchronized/</a></p>
  </div>

</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-26206">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/6718aa2316196e68cefdf5fd09f3c177" srcset="http://gravatar0.233.wiki/avatar/6718aa2316196e68cefdf5fd09f3c177?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-26206">

viviju1989
</span>
     </li>
     <li class="comment-date">2015/06/01 6:13下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fvolatile%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-26206&#39;, &#39;comment-26206&#39;, &#39;comment-content-26206&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-26206">
    <p>问个问题，在文章中有这么两处提到了volatile 可见性的底层实现机制：<br>
1. 有volatile变量修饰的共享变量进行写操作的时候会多第二行汇编代码，通过查IA-32架构软件开发者手册可知，lock前缀的指令在多核处理器下会引发了两件事情：（1）将当前处理器缓存行的数据会写回到系统内存（2）这个写回内存的操作会引起在其他CPU里缓存了该内存地址的数据无效。<br>
2. 在多处理器下，为了保证各个处理器的缓存是一致的，就会实现缓存一致性协议，每个处理器通过嗅探在总线上传播的数据来检查自己缓存的值是不是过期了，当处理器发现自己缓存行对应的内存地址被修改，就会将当前处理器的缓存行设置成无效状态，当处理器要对这个数据进行修改操作的时候，会强制重新从系统内存里把数据读到处理器缓存里。</p>
<p>疑问：<br>
第1点里面提到的引起其他CPU里面缓存了该内存的数据无效：是说如果某个cpu里面缓存的这个修改的volatile变量，当volatile数据写回系统内存时，只会让这个volatile变量数据失效 还是 会让该CPU对应的所有缓存数据失效？</p>
  </div>

</li><!-- #comment-## -->
  </ol>
  <!-- comments END -->

  
 </div><!-- #comment-list END -->


 <div id="trackback_area">
 <!-- start trackback -->
 
  <div id="trackback_url_wrapper">
   <label for="trackback_url">TrackBack 地址</label>
   <input type="text" name="trackback_url" id="trackback_url" size="60" value="http://ifeve.com/volatile/trackback/" readonly="readonly" onfocus="this.select()">
  </div>

  <ol class="commentlist">
         <li class="comment">
    <div class="trackback_time">
     2014/03/14         </div>
    <div class="trackback_title">
     Trackback 来自：<a href="http://www.ng888.com/?p=27">聊聊并发（一）深入分析Volatile的实现原理 | Java学习</a>
    </div>
   </li>
        </ol>

  <!-- trackback end -->
 </div><!-- #trackbacklist END -->

 


 
 <div class="comment_form_wrapper" id="respond">
    您必须 <a href="http://ifeve.com/wp-login.php">登陆</a> 后才能发表评论 </div>

 </div><!-- #comment end -->   </div>
   
      <div id="previous_next_post_single">
    <div class="clearfix">
          <p id="next_post"><a href="http://ifeve.com/java-synchronized/" rel="next">聊聊并发（二）Java SE1.6中的Synchronized</a></p>    </div>
   </div>
   

  </div><!-- END #left_col -->

  <div id="container"></div>

    <div id="right_col">
   

<div class="side_box clearfix" id="side_meta_content">

  <ul id="social_link" class="clearfix">
    <li class="rss_button"><a class="target_blank" href="http://ifeve.com/feed/">rss</a></li>
       </ul>
 
  <div id="search_area">
    <form method="get" id="searchform" action="http://ifeve.com/">
   <div><input id="search_button" class="rollover" type="image" src="./聊聊并发（一）深入分析Volatile的实现原理_files/search_button.gif" alt="搜索一下" title="搜索一下"></div>
   <div><input id="search_input" type="text" value="搜索一下" name="s" onfocus="if (this.value == &#39;搜索一下&#39;) this.value = &#39;&#39;;" onblur="if (this.value == &#39;&#39;) this.value = &#39;搜索一下&#39;;"></div>
  </form>
   </div>
 
</div>


<div id="side_top">

 <div class="side_box widget_text" id="text-17">
			<div class="textwidget"><!-- 请置于所有广告位代码之前 -->
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/m.js"></script>
<script type="text/javascript">
BAIDU_CLB_preloadSlots("980251","980252");
</script><script charset="utf-8" src="./聊聊并发（一）深入分析Volatile的实现原理_files/ecom"></script>
<!-- 广告位：右最上 -->
<script type="text/javascript">BAIDU_CLB_fillSlot("1063991");</script><div id="BAIDU_DUP_wrapper_1063991_0"></div><script charset="utf-8" src="./聊聊并发（一）深入分析Volatile的实现原理_files/ecom(1)"></script><script charset="utf-8" src="./聊聊并发（一）深入分析Volatile的实现原理_files/fixed7o.js"></script>

<p>购买<a href="http://s.click.taobao.com/nMgPIwx" target="_blank">《Java并发编程的艺术》</a>,UCloud提供云服务</p>

<!-- 广告位：首页右上1 -->
<script type="text/javascript">BAIDU_CLB_fillSlot("980251");</script><div id="BAIDU_DUP_wrapper_980251_0"><iframe id="baidu_clb_slot_iframe_980251_0" src="./聊聊并发（一）深入分析Volatile的实现原理_files/聊聊并发（一）深入分析Volatile的实现原理.html" onload="BAIDU_DUP_CLB_renderFrame(&#39;980251_0&#39;)" width="300" height="80" vspace="0" hspace="0" allowtransparency="true" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border:0; vertical-align:bottom; margin:0; display:block;"></iframe></div>

<br>
<script language="javascript"> 
var randomNum = Math.round(Math.random()*2);
var image=new Array(3);
image[0]="http://ww4.sinaimg.cn/mw690/005NgQwbgw1evsy1m5y19j308c028747.jpg";
image[1]="http://ww2.sinaimg.cn/mw690/005NgQwbgw1evsy1kjd94j308c0283yh.jpg";
image[2]="http://ww1.sinaimg.cn/mw690/005NgQwbgw1evsy1iukeij308c028dfu.jpg";
var imageUrl=image[randomNum];
var urls=new Array(3);
urls[0]="http://yun.lu";
urls[1]="http://yun.lu";
urls[2]="http://yun.lu";
var url = urls[randomNum];
var adHTML = "<a href='"+url+"' target='_blank'><img src='"+imageUrl+"' border='0'></a>";
document.write(adHTML);
</script><a href="http://yun.lu/" target="_blank"><img src="./聊聊并发（一）深入分析Volatile的实现原理_files/005NgQwbgw1evsy1m5y19j308c028747.jpg" border="0"></a>

<br>
<!-- 广告位：首页右上2 -->
<script type="text/javascript">BAIDU_CLB_fillSlot("980252");</script><div id="BAIDU_DUP_wrapper_980252_0"></div>
<script async="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="8872369516" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</div>
		<div class="side_box widget_recent_entries" id="recent-posts-2">
		<h3 class="side_title">近期文章</h3>
		<ul>
					<li>
				<a href="http://ifeve.com/ali-think-12/">阿里感悟（十一）如何准备面试</a>
						</li>
					<li>
				<a href="http://ifeve.com/dis-session-manager/">大型网站之分布式会话管理</a>
						</li>
					<li>
				<a href="http://ifeve.com/think-in-ali-10/">阿里感悟（十）如何写好简历</a>
						</li>
					<li>
				<a href="http://ifeve.com/zookeeper-apache/">《ZooKeeper官方指南》翻译邀请</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-dev-kit-working-with-collection/">《Groovy官方文档》Groovy开发套件-使用集合</a>
						</li>
					<li>
				<a href="http://ifeve.com/zookeeperover/">《Apache Zookeeper官方文档》2-综述</a>
						</li>
					<li>
				<a href="http://ifeve.com/json-code-problem/">JSON数据乱码问题</a>
						</li>
					<li>
				<a href="http://ifeve.com/apache-zookeeper-1/">《Apache zookeeper 官方文档》-1简介</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-guide/">《Groovy官方指南》目录</a>
						</li>
					<li>
				<a href="http://ifeve.com/java-io-%e4%b9%8b-outputstream%e6%ba%90%e7%a0%81/">Java IO 之 OutputStream源码</a>
						</li>
					<li>
				<a href="http://ifeve.com/lru-cache/">使用Redis作为一个LRU缓存</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-syntax/">《Groovy语言规范》-语法</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-ides/">《Groovy官方文档》3.4 开发环境支持</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-dev-kit-io/">《Groovy官方文档》Groovy开发套件-使用IO</a>
						</li>
					<li>
				<a href="http://ifeve.com/how-to-navigatehow-to-navigate-and-make-progress/">Adopt Open JDK官方文档(二)如何使用导航和取得进步？</a>
						</li>
					<li>
				<a href="http://ifeve.com/java-io-%e4%b9%8b-inputstream%e6%ba%90%e7%a0%81/">Java IO 之 InputStream源码</a>
						</li>
					<li>
				<a href="http://ifeve.com/static-factory-methods-vs-traditional-constructors/">静态工厂方法VS构造器</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-and-java/">《Groovy官方文档》1.3 Groovy和Java比较</a>
						</li>
					<li>
				<a href="http://ifeve.com/install-groovy/">《Groovy官方文档》1.2安装Groovy</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-download/">《Groovy官方文档》1.1 下载Groovy</a>
						</li>
					<li>
				<a href="http://ifeve.com/fault-tolerance/">容错技术介绍</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy/">《Groovy官方指南》翻译邀请</a>
						</li>
					<li>
				<a href="http://ifeve.com/httpifeve-comvelocity-guide-summary/">Apache Velocity官方指南-总结</a>
						</li>
					<li>
				<a href="http://ifeve.com/java8/">Java8简明指南</a>
						</li>
					<li>
				<a href="http://ifeve.com/adopt-open-jd-10/">Adopt Open JDK官方文档（十）</a>
						</li>
					<li>
				<a href="http://ifeve.com/lock-reentrantlock/">《Java并发编程从入门到精通》显示锁Lock和ReentrantLock</a>
						</li>
					<li>
				<a href="http://ifeve.com/apache-storm/">Apache Storm 官方文档中文版</a>
						</li>
					<li>
				<a href="http://ifeve.com/storm-internal-implementation/">Apache Storm 官方文档 —— 内部技术实现</a>
						</li>
					<li>
				<a href="http://ifeve.com/java-concurrency-thread-safe/">《 Java并发编程从入门到精通》Thread安全与不安全</a>
						</li>
					<li>
				<a href="http://ifeve.com/storm-acking-framework-implementation/">Apache Storm 官方文档 —— Ack 框架的实现</a>
						</li>
				</ul>
		</div>
<div class="side_box widget_text" id="text-10">
			<div class="textwidget"><script async="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/adsbygoogle.js"></script>
<!-- 首页－右上－2 -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="8872369516" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</div>
<div class="side_box widget_views" id="views-4">
<h3 class="side_title">热门文章</h3>
<ul>
<li><a href="http://ifeve.com/google-guava/" title="Google Guava官方教程（中文版）">Google Guava官方教程（中文版）</a> 173,946 人阅读 </li><li><a href="http://ifeve.com/overview/" title="Java NIO系列教程（一） Java NIO 概述">Java NIO系列教程（一） Java NIO 概述</a> 99,608 人阅读 </li><li><a href="http://ifeve.com/java-concurrency-thread-directory/" title="Java并发性和多线程介绍目录">Java并发性和多线程介绍目录</a> 79,136 人阅读 </li><li><a href="http://ifeve.com/java-nio-all/" title="Java NIO 系列教程">Java NIO 系列教程</a> 76,781 人阅读 </li><li><a href="http://ifeve.com/java-nio-vs-io/" title="Java NIO系列教程（十二） Java NIO与IO">Java NIO系列教程（十二） Java NIO与IO</a> 70,124 人阅读 </li><li><a href="http://ifeve.com/java-7-concurrency-cookbook/" title="Java 7 并发编程指南中文版">Java 7 并发编程指南中文版</a> 59,099 人阅读 </li><li><a href="http://ifeve.com/selectors/" title="Java NIO系列教程（六） Selector">Java NIO系列教程（六） Selector</a> 57,665 人阅读 </li><li><a href="http://ifeve.com/channels/" title="Java NIO系列教程（二） Channel">Java NIO系列教程（二） Channel</a> 52,742 人阅读 </li><li><a href="http://ifeve.com/buffers/" title="Java NIO系列教程（三） Buffer">Java NIO系列教程（三） Buffer</a> 51,998 人阅读 </li><li><a href="http://ifeve.com/getting-started-with-stom-index/" title="《Storm入门》中文版">《Storm入门》中文版</a> 45,581 人阅读 </li><li><a href="http://ifeve.com/netty5-user-guide/" title="Netty 5用户指南">Netty 5用户指南</a> 42,229 人阅读 </li><li><a href="http://ifeve.com/disruptor/" title="并发框架Disruptor译文">并发框架Disruptor译文</a> 40,519 人阅读 </li><li><a href="http://ifeve.com/locks-are-bad/" title="剖析Disruptor:为什么会这么快？(一)锁的缺点">剖析Disruptor:为什么会这么快？(一)锁的缺点</a> 39,405 人阅读 </li><li><a href="http://ifeve.com/socket-channel/" title="Java NIO系列教程（八） SocketChannel">Java NIO系列教程（八） SocketChannel</a> 35,958 人阅读 </li><li><a href="http://ifeve.com/perfbook/" title="《深入理解并行编程》中文版">《深入理解并行编程》中文版</a> 35,272 人阅读 </li><li><a href="http://ifeve.com/getting-started-with-storm-1/" title="Storm入门之第一章">Storm入门之第一章</a> 34,564 人阅读 </li><li><a href="http://ifeve.com/file-channel/" title="Java NIO系列教程（七） FileChannel">Java NIO系列教程（七） FileChannel</a> 33,101 人阅读 </li><li><a href="http://ifeve.com/netty1/" title="Netty源码解读（一）概述">Netty源码解读（一）概述</a> 29,926 人阅读 </li><li><a href="http://ifeve.com/google-guava-using-and-avoiding-null/" title="[Google Guava] 1.1-使用和避免null">[Google Guava] 1.1-使用和避免null</a> 29,819 人阅读 </li><li><a href="http://ifeve.com/java-concurrency-constructs/" title="Java并发结构">Java并发结构</a> 29,601 人阅读 </li></ul>
</div>
<div class="side_box widget_text" id="text-7">
			<div class="textwidget"><script async="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="4721371513" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</div>
		</div>
<div class="side_box widget_recent_comments" id="recent-comments-2">
<h3 class="side_title">近期评论</h3>
<ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">yangcheng33</span>发表在《<a href="http://ifeve.com/book/comment-page-1/#comment-26402">《Java并发编程的艺术》勘误和支持</a>》</li><li class="recentcomments"><span class="comment-author-link">yangcheng33</span>发表在《<a href="http://ifeve.com/book/comment-page-1/#comment-26401">《Java并发编程的艺术》勘误和支持</a>》</li><li class="recentcomments"><span class="comment-author-link">平僧</span>发表在《<a href="http://ifeve.com/java-io-network/comment-page-1/#comment-26400">Java IO: 网络</a>》</li><li class="recentcomments"><span class="comment-author-link">ashitaka</span>发表在《<a href="http://ifeve.com/introduce-abstractqueuedsynchronizer/comment-page-1/#comment-26399">AbstractQueuedSynchronizer的介绍和原理分析</a>》</li><li class="recentcomments"><span class="comment-author-link">qooge</span>发表在《<a href="http://ifeve.com/lru-cache/comment-page-1/#comment-26398">使用Redis作为一个LRU缓存</a>》</li><li class="recentcomments"><span class="comment-author-link">sososolo</span>发表在《<a href="http://ifeve.com/lru-cache/comment-page-1/#comment-26397">使用Redis作为一个LRU缓存</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url">方 腾飞</a></span>发表在《<a href="http://ifeve.com/adopt-openjdk-translate-plan/comment-page-1/#comment-26396">Adopt OpenJDK 翻译计划</a>》</li><li class="recentcomments"><span class="comment-author-link">王山山</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26395">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">q1505740617</span>发表在《<a href="http://ifeve.com/adopt-openjdk-translate-plan/comment-page-1/#comment-26394">Adopt OpenJDK 翻译计划</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26393">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">tomasxxoo</span>发表在《<a href="http://ifeve.com/apache-storm/comment-page-1/#comment-26392">Apache Storm 官方文档中文版</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url">方 腾飞</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26391">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url">方 腾飞</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26390">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26389">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url">方 腾飞</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26388">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26387">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26386">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.jamespan.me/blog/" rel="external nofollow" class="url">JamesPan</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26385">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.jamespan.me/blog/" rel="external nofollow" class="url">JamesPan</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26384">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.jamespan.me/blog/" rel="external nofollow" class="url">JamesPan</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26383">《Groovy官方指南》翻译邀请</a>》</li></ul></div>
<div class="side_box widget_tag_cloud" id="tag_cloud-4">
<h3 class="side_title">标签</h3>
<div class="tagcloud"><a href="http://ifeve.com/tag/actor/" class="tag-link-226" title="17个话题" style="font-size: 13.572815533981pt;">actor</a>
<a href="http://ifeve.com/tag/basic/" class="tag-link-213" title="14个话题" style="font-size: 12.485436893204pt;">Basic</a>
<a href="http://ifeve.com/tag/book/" class="tag-link-243" title="7个话题" style="font-size: 8.6796116504854pt;">book</a>
<a href="http://ifeve.com/tag/cacheline/" class="tag-link-77" title="6个话题" style="font-size: 8pt;">cacheline</a>
<a href="http://ifeve.com/tag/classes/" class="tag-link-251" title="8个话题" style="font-size: 9.3592233009709pt;">classes</a>
<a href="http://ifeve.com/tag/collections/" class="tag-link-260" title="11个话题" style="font-size: 11.126213592233pt;">collections</a>
<a href="http://ifeve.com/tag/concurrency/" class="tag-link-111" title="66个话题" style="font-size: 21.320388349515pt;">concurrency</a>
<a href="http://ifeve.com/tag/concurrent/" class="tag-link-214" title="11个话题" style="font-size: 11.126213592233pt;">Concurrent</a>
<a href="http://ifeve.com/tag/concurrent-data-structure/" class="tag-link-322" title="13个话题" style="font-size: 12.077669902913pt;">concurrent data structure</a>
<a href="http://ifeve.com/tag/concurrenthashmap/" class="tag-link-61" title="6个话题" style="font-size: 8pt;">ConcurrentHashMap</a>
<a href="http://ifeve.com/tag/customizing/" class="tag-link-250" title="8个话题" style="font-size: 9.3592233009709pt;">Customizing</a>
<a href="http://ifeve.com/tag/date/" class="tag-link-505" title="7个话题" style="font-size: 8.6796116504854pt;">date</a>
<a href="http://ifeve.com/tag/executor/" class="tag-link-177" title="20个话题" style="font-size: 14.388349514563pt;">Executor</a>
<a href="http://ifeve.com/tag/executor-framework/" class="tag-link-231" title="17个话题" style="font-size: 13.572815533981pt;">Executor framework</a>
<a href="http://ifeve.com/tag/false-sharing/" class="tag-link-119" title="7个话题" style="font-size: 8.6796116504854pt;">False Sharing</a>
<a href="http://ifeve.com/tag/faq/" class="tag-link-39" title="13个话题" style="font-size: 12.077669902913pt;">faq</a>
<a href="http://ifeve.com/tag/fork/" class="tag-link-232" title="11个话题" style="font-size: 11.126213592233pt;">fork</a>
<a href="http://ifeve.com/tag/forkjoin/" class="tag-link-224" title="9个话题" style="font-size: 10.038834951456pt;">Fork/Join</a>
<a href="http://ifeve.com/tag/fork-join/" class="tag-link-53" title="8个话题" style="font-size: 9.3592233009709pt;">fork join</a>
<a href="http://ifeve.com/tag/framework/" class="tag-link-73" title="22个话题" style="font-size: 14.932038834951pt;">Framework</a>
<a href="http://ifeve.com/tag/functional-programming/" class="tag-link-460" title="9个话题" style="font-size: 10.038834951456pt;">Functional Programming</a>
<a href="http://ifeve.com/tag/guava/" class="tag-link-309" title="14个话题" style="font-size: 12.485436893204pt;">Guava</a>
<a href="http://ifeve.com/tag/io/" class="tag-link-129" title="26个话题" style="font-size: 15.883495145631pt;">IO</a>
<a href="http://ifeve.com/tag/java/" class="tag-link-69" title="74个话题" style="font-size: 22pt;">JAVA</a>
<a href="http://ifeve.com/tag/java8/" class="tag-link-342" title="10个话题" style="font-size: 10.582524271845pt;">java8</a>
<a href="http://ifeve.com/tag/jmm/" class="tag-link-31" title="31个话题" style="font-size: 16.970873786408pt;">jmm</a>
<a href="http://ifeve.com/tag/join/" class="tag-link-233" title="11个话题" style="font-size: 11.126213592233pt;">join</a>
<a href="http://ifeve.com/tag/jvm/" class="tag-link-127" title="16个话题" style="font-size: 13.165048543689pt;">JVM</a>
<a href="http://ifeve.com/tag/lock/" class="tag-link-17" title="23个话题" style="font-size: 15.203883495146pt;">lock</a>
<a href="http://ifeve.com/tag/memory-barriers/" class="tag-link-75" title="10个话题" style="font-size: 10.582524271845pt;">Memory Barriers</a>
<a href="http://ifeve.com/tag/netty/" class="tag-link-280" title="16个话题" style="font-size: 13.165048543689pt;">Netty</a>
<a href="http://ifeve.com/tag/nio/" class="tag-link-131" title="14个话题" style="font-size: 12.485436893204pt;">NIO</a>
<a href="http://ifeve.com/tag/oauth-2-0/" class="tag-link-380" title="8个话题" style="font-size: 9.3592233009709pt;">OAuth 2.0</a>
<a href="http://ifeve.com/tag/pattern-matching/" class="tag-link-167" title="8个话题" style="font-size: 9.3592233009709pt;">pattern-matching</a>
<a href="http://ifeve.com/tag/ringbuffer/" class="tag-link-91" title="7个话题" style="font-size: 8.6796116504854pt;">RingBuffer</a>
<a href="http://ifeve.com/tag/scala/" class="tag-link-166" title="22个话题" style="font-size: 14.932038834951pt;">Scala</a>
<a href="http://ifeve.com/tag/stm/" class="tag-link-199" title="12个话题" style="font-size: 11.533980582524pt;">stm</a>
<a href="http://ifeve.com/tag/storm/" class="tag-link-351" title="39个话题" style="font-size: 18.194174757282pt;">Storm</a>
<a href="http://ifeve.com/tag/synchronization/" class="tag-link-216" title="15个话题" style="font-size: 12.757281553398pt;">synchronization</a>
<a href="http://ifeve.com/tag/synchronized/" class="tag-link-15" title="10个话题" style="font-size: 10.582524271845pt;">Synchronized</a>
<a href="http://ifeve.com/tag/thread/" class="tag-link-11" title="41个话题" style="font-size: 18.466019417476pt;">thread</a>
<a href="http://ifeve.com/tag/time/" class="tag-link-506" title="7个话题" style="font-size: 8.6796116504854pt;">time</a>
<a href="http://ifeve.com/tag/tomcat/" class="tag-link-347" title="8个话题" style="font-size: 9.3592233009709pt;">tomcat</a>
<a href="http://ifeve.com/tag/volatile/" class="tag-link-25" title="11个话题" style="font-size: 11.126213592233pt;">volatile</a>
<a href="http://ifeve.com/tag/%e5%a4%9a%e7%ba%bf%e7%a8%8b/" class="tag-link-197" title="8个话题" style="font-size: 9.3592233009709pt;">多线程</a></div>
</div>
<div class="side_box widget_text" id="text-9">
			<div class="textwidget"><script async="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="6198104715" data-adsbygoogle-status="done"><ins id="aswift_3_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


</div>
		</div>
</div>
<div id="side_middle" class="clearfix">
 <div id="side_left">
  <div class="side_box_short widget_archive" id="archives-2">
<h3 class="side_title">文章归档</h3>
		<ul>
	<li><a href="http://ifeve.com/2015/10/">2015年十月</a>&nbsp;(8)</li>
	<li><a href="http://ifeve.com/2015/09/">2015年九月</a>&nbsp;(29)</li>
	<li><a href="http://ifeve.com/2015/08/">2015年八月</a>&nbsp;(44)</li>
	<li><a href="http://ifeve.com/2015/07/">2015年七月</a>&nbsp;(20)</li>
	<li><a href="http://ifeve.com/2015/06/">2015年六月</a>&nbsp;(21)</li>
	<li><a href="http://ifeve.com/2015/05/">2015年五月</a>&nbsp;(15)</li>
	<li><a href="http://ifeve.com/2015/04/">2015年四月</a>&nbsp;(27)</li>
	<li><a href="http://ifeve.com/2015/03/">2015年三月</a>&nbsp;(13)</li>
	<li><a href="http://ifeve.com/2015/02/">2015年二月</a>&nbsp;(11)</li>
	<li><a href="http://ifeve.com/2015/01/">2015年一月</a>&nbsp;(13)</li>
	<li><a href="http://ifeve.com/2014/12/">2014年十二月</a>&nbsp;(26)</li>
	<li><a href="http://ifeve.com/2014/11/">2014年十一月</a>&nbsp;(61)</li>
	<li><a href="http://ifeve.com/2014/10/">2014年十月</a>&nbsp;(33)</li>
	<li><a href="http://ifeve.com/2014/09/">2014年九月</a>&nbsp;(47)</li>
	<li><a href="http://ifeve.com/2014/08/">2014年八月</a>&nbsp;(27)</li>
	<li><a href="http://ifeve.com/2014/07/">2014年七月</a>&nbsp;(13)</li>
	<li><a href="http://ifeve.com/2014/06/">2014年六月</a>&nbsp;(32)</li>
	<li><a href="http://ifeve.com/2014/05/">2014年五月</a>&nbsp;(45)</li>
	<li><a href="http://ifeve.com/2014/04/">2014年四月</a>&nbsp;(41)</li>
	<li><a href="http://ifeve.com/2014/03/">2014年三月</a>&nbsp;(34)</li>
	<li><a href="http://ifeve.com/2014/02/">2014年二月</a>&nbsp;(38)</li>
	<li><a href="http://ifeve.com/2014/01/">2014年一月</a>&nbsp;(19)</li>
	<li><a href="http://ifeve.com/2013/12/">2013年十二月</a>&nbsp;(10)</li>
	<li><a href="http://ifeve.com/2013/11/">2013年十一月</a>&nbsp;(5)</li>
	<li><a href="http://ifeve.com/2013/10/">2013年十月</a>&nbsp;(20)</li>
	<li><a href="http://ifeve.com/2013/09/">2013年九月</a>&nbsp;(38)</li>
	<li><a href="http://ifeve.com/2013/08/">2013年八月</a>&nbsp;(48)</li>
	<li><a href="http://ifeve.com/2013/07/">2013年七月</a>&nbsp;(26)</li>
	<li><a href="http://ifeve.com/2013/06/">2013年六月</a>&nbsp;(16)</li>
	<li><a href="http://ifeve.com/2013/05/">2013年五月</a>&nbsp;(9)</li>
	<li><a href="http://ifeve.com/2013/04/">2013年四月</a>&nbsp;(17)</li>
	<li><a href="http://ifeve.com/2013/03/">2013年三月</a>&nbsp;(41)</li>
	<li><a href="http://ifeve.com/2013/02/">2013年二月</a>&nbsp;(25)</li>
	<li><a href="http://ifeve.com/2013/01/">2013年一月</a>&nbsp;(57)</li>
	<li><a href="http://ifeve.com/2012/12/">2012年十二月</a>&nbsp;(9)</li>
	<li><a href="http://ifeve.com/2012/10/">2012年十月</a>&nbsp;(1)</li>
	<li><a href="http://ifeve.com/2012/08/">2012年八月</a>&nbsp;(1)</li>
		</ul>
</div>
 </div>
 <div id="side_right">
  <div class="side_box_short widget_links" id="linkcat-2">
<h3 class="side_title">友情链接</h3>

	<ul class="xoxo blogroll">
<li><a href="http://coolshell.cn/" rel="co-worker" target="_blank">coolshell</a></li>
<li><a href="http://blog.91gaoqing.com/" target="_blank">Programer. 大猫</a></li>
<li><a href="http://hugozhu.myalert.info/" rel="co-worker" target="_blank">一粟的博客</a></li>
<li><a href="http://bj.liepin.com/">北京猎聘网</a></li>
<li><a href="http://blog.csdn.net/cutesource/" rel="acquaintance co-worker" target="_blank">志俊的博客</a></li>
<li><a href="http://www.zuidaima.com/">最代码</a></li>
<li><a href="http://diandianzhe.com/">点点折</a></li>
<li><a href="http://www.liuinsect.com/">码梦为生</a></li>
<li><a href="http://namiao.org/" rel="acquaintance co-worker" target="_blank">纳秒</a></li>
<li><a href="http://www.656463.com/">领悟书生</a></li>

	</ul>
</div>

<div class="side_box_short widget_categories" id="categories-2">
<h3 class="side_title">分类目录</h3>
		<ul>
	<li class="cat-item cat-item-387"><a href="http://ifeve.com/category/framework/akka/">akka</a> (18)
</li>
	<li class="cat-item cat-item-415"><a href="http://ifeve.com/category/android/">Android</a> (3)
</li>
	<li class="cat-item cat-item-289"><a href="http://ifeve.com/category/c/">C++</a> (11)
</li>
	<li class="cat-item cat-item-366"><a href="http://ifeve.com/category/cpu-2/">CPU</a> (2)
</li>
	<li class="cat-item cat-item-73"><a href="http://ifeve.com/category/framework/">Framework</a> (45)
</li>
	<li class="cat-item cat-item-458"><a href="http://ifeve.com/category/go/">GO</a> (6)
</li>
	<li class="cat-item cat-item-617"><a href="http://ifeve.com/category/groovy/">groovy</a> (6)
</li>
	<li class="cat-item cat-item-310"><a href="http://ifeve.com/category/guava-2/">guava</a> (22)
</li>
	<li class="cat-item cat-item-69"><a href="http://ifeve.com/category/java/">JAVA</a> (372)
</li>
	<li class="cat-item cat-item-127"><a href="http://ifeve.com/category/jvm/">JVM</a> (34)
</li>
	<li class="cat-item cat-item-300"><a href="http://ifeve.com/category/linux/">linux</a> (7)
</li>
	<li class="cat-item cat-item-280"><a href="http://ifeve.com/category/netty/">Netty</a> (22)
</li>
	<li class="cat-item cat-item-166"><a href="http://ifeve.com/category/scala/">Scala</a> (9)
</li>
	<li class="cat-item cat-item-388"><a href="http://ifeve.com/category/storm/">storm</a> (42)
</li>
	<li class="cat-item cat-item-620"><a href="http://ifeve.com/category/thinking/">thinking</a> (1)
</li>
	<li class="cat-item cat-item-485"><a href="http://ifeve.com/category/velocity/">Velocity</a> (6)
</li>
	<li class="cat-item cat-item-279"><a href="http://ifeve.com/category/web/">Web</a> (13)
</li>
	<li class="cat-item cat-item-148"><a href="http://ifeve.com/category/notice/">公告</a> (5)
</li>
	<li class="cat-item cat-item-378"><a href="http://ifeve.com/category/bigdata/">大数据</a> (22)
</li>
	<li class="cat-item cat-item-138"><a href="http://ifeve.com/category/%e5%a5%bd%e6%96%87%e6%8e%a8%e8%8d%90/">好文推荐</a> (26)
</li>
	<li class="cat-item cat-item-244"><a href="http://ifeve.com/category/%e5%b9%b6%e5%8f%91%e4%b9%a6%e7%b1%8d/">并发书籍</a> (95)
</li>
	<li class="cat-item cat-item-29"><a href="http://ifeve.com/category/concurrency-translation/" title="发布国外并发编程相关文献译文。">并发译文</a> (359)
</li>
	<li class="cat-item cat-item-7"><a href="http://ifeve.com/category/ask/" title="可以在这里发表并发编程的问题。如何发表？用QQ登陆，然后点击“新建文章”，管理员审核后就可以发表。">技术问答</a> (11)
</li>
	<li class="cat-item cat-item-147"><a href="http://ifeve.com/category/%e6%95%8f%e6%8d%b7%e7%ae%a1%e7%90%86/">敏捷管理</a> (5)
</li>
	<li class="cat-item cat-item-1"><a href="http://ifeve.com/category/talk-concurrent/">本站原创</a> (72)
</li>
	<li class="cat-item cat-item-367"><a href="http://ifeve.com/category/%e6%9e%b6%e6%9e%84/">架构</a> (19)
</li>
	<li class="cat-item cat-item-305"><a href="http://ifeve.com/category/%e6%b4%bb%e5%8a%a8/">活动</a> (7)
</li>
	<li class="cat-item cat-item-414"><a href="http://ifeve.com/category/%e7%bd%91%e7%bb%9c/">网络</a> (3)
</li>
		</ul>
</div>
 </div>
</div>
<div id="side_bottom">
 <div class="side_box widget_text" id="text-15">
			<div class="textwidget"><script async="" src="./聊聊并发（一）深入分析Volatile的实现原理_files/adsbygoogle.js"></script>
<!-- 摩天大楼 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="6358703113" data-adsbygoogle-status="done"><ins id="aswift_4_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><ins id="aswift_4_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><iframe width="300" height="600" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_4" name="aswift_4" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- CNZZ -->
<script src="./聊聊并发（一）深入分析Volatile的实现原理_files/stat.php" language="JavaScript"></script><script src="./聊聊并发（一）深入分析Volatile的实现原理_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=5003572" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="./聊聊并发（一）深入分析Volatile的实现原理_files/pic.gif"></a>

感谢<a href="https://www.upyun.com/index.html" target="_blank">又拍云</a>为本站提供服务器和图片服务。</div>
		</div>
</div>

  </div>
  
  <div id="footer">

<ul id="copyright">
    <li>版权所有 ©&nbsp; <a href="http://ifeve.com/">并发编程网 – ifeve.com</a></li>
    <li>ICP号: <a href="http://www.miibeian.gov.cn/" target="_blank">浙ICP备12046809号</a></li>
<li class="last"><script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/tongji.js"></script><img src="./聊聊并发（一）深入分析Volatile的实现原理_files/tongji.do" border="0" width="1" height="1"><a href="http://tongji.linezing.com/report.html?unit_id=3067707" target="_blank">量子统计</a><noscript>&lt;a href="http://www.linezing.com"&gt;&lt;img src="http://img.tongji.linezing.com/3067707/tongji.gif"/&gt;&lt;/a&gt;</noscript></li>
   </ul>
 </div>
 </div><!-- END #main_content -->

  <p id="return_top"><a href="http://ifeve.com/volatile/#header">return top</a></p>
 
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/shCore.js"></script>
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/shBrushJava.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shCore.css?ver=2.1.364";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shThemeEclipse.css?ver=2.1.364";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.clipboardSwf = 'http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf';
	SyntaxHighlighter.config.strings.expandSource = 'show source';
	SyntaxHighlighter.config.strings.viewSource = '查看源代码';
	SyntaxHighlighter.config.strings.copyToClipboard = '复制到剪贴板';
	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = '代码现在在你的剪贴板';
	SyntaxHighlighter.config.strings.print = '打印';
	SyntaxHighlighter.config.strings.help = '帮助';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = '无法找到Brush：';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush不能设置 html-script选项';
	SyntaxHighlighter.defaults['pad-line-numbers'] = true;
	SyntaxHighlighter.all();
</script>
<link rel="stylesheet" id="yarppRelatedCss-css" href="./聊聊并发（一）深入分析Volatile的实现原理_files/related.css" type="text/css" media="all">
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var ratingsL10n = {"plugin_url":"http:\/\/ifeve.com\/wp-content\/plugins\/wp-postratings","ajax_url":"http:\/\/ifeve.com\/wp-admin\/admin-ajax.php","text_wait":"Please rate only 1 post at a time.","image":"stars_crystal","image_ext":"gif","max":"5","show_loading":"1","show_fading":"1","custom":"0"};
var ratings_mouseover_image=new Image();ratings_mouseover_image.src=ratingsL10n.plugin_url+"/images/"+ratingsL10n.image+"/rating_over."+ratingsL10n.image_ext;;
/* ]]> */
</script>
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/postratings-js.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/ifeve.com\/wp-admin\/admin-ajax.php","post_id":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./聊聊并发（一）深入分析Volatile的实现原理_files/postviews-cache.js"></script>



<script src="./聊聊并发（一）深入分析Volatile的实现原理_files/jquery.min.js"></script>

<script src="./聊聊并发（一）深入分析Volatile的实现原理_files/jquery.bpopup-0.8.0.min.js"></script>


<!--
<script type="text/javascript">

;(function($) {

    $(function() {

        var url=document.referrer;

        if ( url && url.search("http://")>-1) {

            var refurl =  url.match(/:\/\/(.[^/]+)/)[1];

            if(refurl.indexOf("baidu.com")>-1){

                $('#nobaidu_dlg').bPopup();

            }

        }

    });



})(jQuery);

</script>




<div id="nobaidu_dlg" style="background-color:#fff; border-radius:15px;color:#000;display:none;padding:20px;min-width:450px;min-height:180px;">

    <span class="bClose" style="cursor:pointer; position:absolute; right:10px;top:5px;">x<span/>

    <img src="http://coolshell.cn//wp-content/themes/inove/img/nobaidu.jpg" align="left">

     <p style="margin-left:200px;margin-top: 20px; line-height: 30px;">

     检测到你还在使用百度这个搜索引擎，<br/>

     做为一个程序员，这是一种自暴自弃！<br/>

     <br/>

     </p>

     <p align="center" style="margin-top:20px;">

     <b><a href="http://coolshell.cn/articles/7186.html">作环保的程序员，从不用百度开始！</a></b>

     </p>

</div>
-->

<!-- Dynamic page generated in 1.341 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2015-10-08 08:35:54 -->
</body></html>