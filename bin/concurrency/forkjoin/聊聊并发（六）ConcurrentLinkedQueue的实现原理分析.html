<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0039)http://ifeve.com/concurrentlinkedqueue/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/ca-pub-9394337417063147.js"></script><script src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/shares.php" charset="utf-8"></script><script src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/id.php" charset="utf-8"></script>


<title>聊聊并发（六）ConcurrentLinkedQueue的实现原理分析 | 并发编程网 - ifeve.com</title>
<meta name="description" content="让天下没有难学的技术">

<link rel="alternate" type="application/rss+xml" title="并发编程网 – ifeve.com RSS Feed" href="http://ifeve.com/feed/">
<link rel="alternate" type="application/atom+xml" title="并发编程网 – ifeve.com Atom Feed" href="http://ifeve.com/feed/atom/"> 
<link rel="pingback" href="http://ifeve.com/xmlrpc.php">

<link rel="stylesheet" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/style.css" type="text/css">
<link rel="stylesheet" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/comment-style.css" type="text/css">

 

<!-- All in One SEO Pack 2.2.7.1 by Michael Torbert of Semper Fi Web Design[258,326] -->
<meta name="description" itemprop="description" content="本文是作者原创，首发于InfoQ：http://www.infoq.com/cn/articles/ConcurrentLinkedQueue 1.   ">

<meta name="keywords" itemprop="keywords" content="concurrentlinkedqueue">

<link rel="canonical" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/聊聊并发（六）ConcurrentLinkedQueue的实现原理分析.html">
<!-- /all in one seo pack -->
<link rel="alternate" type="application/rss+xml" title="并发编程网 - ifeve.com » 聊聊并发（六）ConcurrentLinkedQueue的实现原理分析评论Feed" href="http://ifeve.com/concurrentlinkedqueue/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/ifeve.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.5"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/wp-emoji-release.min.js" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="yarppWidgetCss-css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/widget.css" type="text/css" media="all">
<link rel="stylesheet" id="dwqa-style-css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/style(1).css" type="text/css" media="all">
<link rel="stylesheet" id="wp-postratings-css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/postratings-css.css" type="text/css" media="all">
<link rel="stylesheet" id="display-authors-widget-styles-css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/display-authors-widget.css" type="text/css" media="all">
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jquery.js"></script>
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jquery-migrate.min.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://ifeve.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://ifeve.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="看动画学并发编程" href="http://ifeve.com/java-concurrent-animated/">
<link rel="next" title="并发译文翻译计划（二）" href="http://ifeve.com/transation-plan-2/">
<meta name="generator" content="WordPress 4.2.5">
<link rel="shortlink" href="http://ifeve.com/?p=1541">


<!-- Plugin: Open external links a new window. Plugin by Kristian Risager Larsen, http://kristianrisagerlarsen.dk . Download it at http://wordpress.org/extend/plugins/open-external-links-in-a-new-window/ -->
<script type="text/javascript">//<![CDATA[
	function external_links_in_new_windows_loop() {
		if (!document.links) {
			document.links = document.getElementsByTagName('a');
		}
		var change_link = false;
		var force = '';
		var ignore = '';

		for (var t=0; t<document.links.length; t++) {
			var all_links = document.links[t];
			change_link = false;
			
			if(document.links[t].hasAttribute('onClick') == false) {
				// forced if the address starts with http (or also https), but does not link to the current domain
				if(all_links.href.search(/^http/) != -1 && all_links.href.search('ifeve.com') == -1) {
					// alert('Changeda '+all_links.href);
					change_link = true;
				}
					
				if(force != '' && all_links.href.search(force) != -1) {
					// forced
					// alert('force '+all_links.href);
					change_link = true;
				}
				
				if(ignore != '' && all_links.href.search(ignore) != -1) {
					// alert('ignore '+all_links.href);
					// ignored
					change_link = false;
				}

				if(change_link == true) {
					// alert('Changed '+all_links.href);
					document.links[t].setAttribute('onClick', 'javascript:window.open(\''+all_links.href+'\'); return false;');
					document.links[t].removeAttribute('target');
				}
			}
		}
	}
	
	// Load
	function external_links_in_new_windows_load(func)
	{	
		var oldonload = window.onload;
		if (typeof window.onload != 'function'){
			window.onload = func;
		} else {
			window.onload = function(){
				oldonload();
				func();
			}
		}
	}

	external_links_in_new_windows_load(external_links_in_new_windows_loop);
	//]]></script>


<!-- StarBox - the Author Box for Humans 3.0.4, visit: http://wordpress.org/plugins/starbox/ -->
<!-- /StarBox - the Author Box for Humans -->

<link rel="stylesheet" id="frontend.css-css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/frontend.css" type="text/css" media="all">
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/frontend.js"></script>
<link rel="stylesheet" id="hidedefault.css-css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/hidedefault.css" type="text/css" media="all">
<style type="text/css" media="screen">#wp-admin-bar-user-info .avatar-64 {width:64px}</style>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="stylesheet" type="text/css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/shCore.css"><link rel="stylesheet" type="text/css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/shThemeEclipse.css"><style type="text/css" id="syntaxhighlighteranchor"></style>

<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jscript.js"></script>
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/comment.js"></script>
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/rollover.js"></script>

<!--[if IE 7]>
<link rel="stylesheet" href="http://ifeve.com/wp-content/themes/flat/ie7.css" type="text/css" />
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="http://ifeve.com/wp-content/themes/flat/ie8.css" type="text/css" />
<![endif]-->


<style type="text/css">
a, .post .title a:hover, .post_meta a:hover, #bread_crumb ul li a:hover, #previous_post a:hover, #next_post a:hover, .post a.more-link:hover, #right_col li a:hover, #copyright li a:hover, #archive_headline #keyword,
   #comments_wrapper a:hover, #comment_header_right .comment_switch_active a, #comment_header_right .comment_switch_active a:hover, #comment_pager .current
   { color:#00A19E; }

#no_post a.back:hover, #wp-calendar td a:hover, #wp-calendar #prev a:hover, #wp-calendar #next a:hover, .page_navi a:hover, #submit_comment:hover
 { background-color:#00A19E; }

#guest_info input:focus, #comment_textarea textarea:focus
 { border:1px solid #00A19E; }

a:hover
 { color:#BDC900; }

body { font-size:14px; }

#header { background:url(http://ifeve.com/wp-content/uploads/flat/bg.png) left top; }
.logo_text a { color:#F5F5F5; }
#site_description {  border-top:1px solid #BBBBBB; color:#D2D9CC; }


</style>

</head>

<body style="zoom: 1;"><div id="BAIDU_DUP_fp_wrapper" style="position: absolute; left: -1px; bottom: -1px; z-index: 0; width: 0px; height: 0px; overflow: hidden; visibility: hidden; display: none;"><iframe id="BAIDU_DUP_fp_iframe" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/o.html" style="width: 0px; height: 0px; visibility: hidden; display: none;"></iframe></div><link href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jiathis_counter.css" rel="stylesheet" type="text/css"><link href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jiathis_share.css" rel="stylesheet" type="text/css"><iframe frameborder="0" style="position: absolute; display: none; opacity: 0;"></iframe><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; top: 50%; left: 50%; overflow: auto;"></div><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; overflow: auto;"></div><iframe frameborder="0" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jiathis_utility.html" style="display: none;"></iframe>

 <div id="header">
  <div class="header_menu">
    <ul id="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95" class="menu"><li id="menu-item-16594" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-16594"><a href="http://ifeve.com/">首页</a></li>
<li id="menu-item-3432" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3432"><a href="http://ifeve.com/wp-login.php">登录</a></li>
<li id="menu-item-17079" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-17079"><a href="http://ifeve.com/questions/">面试题</a></li>
<li id="menu-item-9219" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-9219"><a href="http://ifeve.com/category/java/">JAVA</a>
<ul class="sub-menu">
	<li id="menu-item-16108" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16108"><a href="http://ifeve.com/java-io/">Java IO 教程</a></li>
	<li id="menu-item-5283" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5283"><a href="http://ifeve.com/java-nio-all/">Java NIO 教程</a></li>
	<li id="menu-item-17514" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17514"><a href="http://ifeve.com/java-reflection/">JAVA Reflection教程</a></li>
	<li id="menu-item-16239" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16239"><a href="http://ifeve.com/java-network">Java 网络教程</a></li>
	<li id="menu-item-4416" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4416"><a href="http://ifeve.com/java-concurrency-thread-directory/">Java并发和多线程</a></li>
	<li id="menu-item-2767" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2767"><a href="http://ifeve.com/jmm-cookbook/">Java内存模型指南</a></li>
	<li id="menu-item-2747" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2747"><a href="http://ifeve.com/jmm-faq/">Java内存模型FAQ</a></li>
	<li id="menu-item-2765" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2765"><a href="http://ifeve.com/syn-jmm/">同步与Java内存模型</a></li>
	<li id="menu-item-5789" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5789"><a href="http://ifeve.com/oracle-java-concurrency-tutorial/">Oracle官方并发教程</a></li>
	<li id="menu-item-15316" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15316"><a href="http://ifeve.com/jvm-optimize/">JVM性能优化系列</a></li>
	<li id="menu-item-15313" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15313"><a href="http://ifeve.com/useful-jvm-flags/">JVM实用参数系列</a></li>
</ul>
</li>
<li id="menu-item-7938" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7938"><a href="http://ifeve.com/category/c/">C++</a></li>
<li id="menu-item-9220" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-9220"><a href="http://ifeve.com/category/framework/">Framework</a>
<ul class="sub-menu">
	<li id="menu-item-12798" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12798"><a href="http://ifeve.com/disruptor/">Disruptor 框架指南</a></li>
	<li id="menu-item-12783" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12783"><a title="Netty" href="http://ifeve.com/category/netty/">Netty</a></li>
	<li id="menu-item-12791" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12791"><a href="http://ifeve.com/category/scala/">Scala</a></li>
	<li id="menu-item-12312" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12312"><a href="http://ifeve.com/getting-started-with-stom-index/">Storm 入门</a></li>
	<li id="menu-item-9218" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9218"><a href="http://ifeve.com/google-guava/">Guava 官方指南</a></li>
	<li id="menu-item-20471" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20471"><a href="http://ifeve.com/velocity-guide/">Apache Velocity 官方指南</a></li>
	<li id="menu-item-21439" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21439"><a href="http://ifeve.com/storm-translation/">Apache Storm 官方文档</a></li>
</ul>
</li>
<li id="menu-item-555" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-555"><a href="http://ifeve.com/category/concurrency-translation/">其他译文</a>
<ul class="sub-menu">
	<li id="menu-item-2777" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2777"><a href="http://ifeve.com/java-concurrent/">并发基础</a></li>
	<li id="menu-item-3340" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3340"><a href="http://ifeve.com/aqs/">j.u.c同步框架</a></li>
	<li id="menu-item-2769" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2769"><a href="http://ifeve.com/fj/">Fork Join框架</a></li>
	<li id="menu-item-9221" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9221"><a href="http://ifeve.com/doug-lea/">Doug Lea 论文</a></li>
	<li id="menu-item-4643" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4643"><a href="http://ifeve.com/mechanical-sympathy/">Mechanical Sympathy</a></li>
	<li id="menu-item-6397" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6397"><a href="http://ifeve.com/stm/">软件事务内存导论</a></li>
	<li id="menu-item-10845" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10845"><a href="http://ifeve.com/jsr133-cn/">JSR133中文版</a></li>
</ul>
</li>
<li id="menu-item-103" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-103"><a href="http://ifeve.com/category/talk-concurrent/">本站原创</a>
<ul class="sub-menu">
	<li id="menu-item-2763" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2763"><a href="http://ifeve.com/talk-concurrency/">聊聊并发</a></li>
	<li id="menu-item-2753" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2753"><a href="http://ifeve.com/java-memory-model-0/">深入理解Java内存模型</a></li>
	<li id="menu-item-4862" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4862"><a href="http://ifeve.com/from-javaeye-sys-struct/">从Java视角理解系统结构</a></li>
	<li id="menu-item-4627" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4627"><a href="http://ifeve.com/ali-itu-agile/">阿里内贸团队敏捷实践</a></li>
</ul>
</li>
<li id="menu-item-7119" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-7119"><a href="http://ifeve.com/category/%e5%b9%b6%e5%8f%91%e4%b9%a6%e7%b1%8d/">并发书籍</a>
<ul class="sub-menu">
	<li id="menu-item-10846" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10846"><a href="http://ifeve.com/art-of-java-concurrent-program/">《Java 并发编程的艺术》迷你书</a></li>
	<li id="menu-item-6042" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6042"><a href="http://ifeve.com/perfbook/">《深入理解并行编程》</a></li>
	<li id="menu-item-9172" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9172"><a href="http://ifeve.com/c-plus-plus-concurrency-in-action/">《C++ 并发编程》</a></li>
	<li id="menu-item-7785" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7785"><a href="http://ifeve.com/java-7-concurrency-cookbook/">《Java 7 并发编程指南》</a></li>
	<li id="menu-item-7120" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7120"><a href="http://ifeve.com/jvm-concurrency">《Java 虚拟机并发编程》</a></li>
	<li id="menu-item-12360" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12360"><a href="http://ifeve.com/getting-started-with-stom-index/">《Storm入门》中文版</a></li>
</ul>
</li>
<li id="menu-item-9171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-9171"><a href="http://ifeve.com/need-you/">加入我们</a>
<ul class="sub-menu">
	<li id="menu-item-3246" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3246"><a href="http://ifeve.com/contribute/">我要投稿</a></li>
	<li id="menu-item-6854" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6854"><a href="http://ifeve.com/neitui/">内推阿里</a></li>
</ul>
</li>
<li id="menu-item-105" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-105"><a href="http://ifeve.com/about-site/">关于本站</a>
<ul class="sub-menu">
	<li id="menu-item-11306" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11306"><a href="http://ifeve.com/category/%e6%b4%bb%e5%8a%a8/">活动</a></li>
	<li id="menu-item-1487" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1487"><a href="http://ifeve.com/sitemap.html">文章归档</a></li>
	<li id="menu-item-131" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-131"><a href="http://ifeve.com/about-site/about-me/">关于清英</a></li>
	<li id="menu-item-7600" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7600"><a href="http://ifeve.com/ads/">广告合作</a></li>
</ul>
</li>
</ul>    </div>
  <!-- logo -->
  <h1 class="logo_text"><a href="http://ifeve.com/">并发编程网 - ifeve.com</a></h1>
<h2 id="site_description">让天下没有难学的技术</h2>
 </div>

 <div id="main_content" class="clearfix">

  <div id="left_col">
      <div id="bread_crumb">
    <ul class="clearfix">
     <li id="bc_home"><a href="http://ifeve.com/" title="首页">首页</a></li>
     <li id="bc_cat"><a href="http://ifeve.com/category/talk-concurrent/">本站原创</a></li>     <li class="last">聊聊并发（六）ConcurrentLinkedQueue的实现原理分析</li>
    </ul>
   </div>
   
   
   <div class="post_wrap clearfix" id="single">
    <div class="post">
     <h3 class="title"><span>聊聊并发（六）ConcurrentLinkedQueue的实现原理分析</span></h3>
     <div class="post_content">
      <p>本文是作者原创，首发于InfoQ：<a href="http://www.infoq.com/cn/articles/ConcurrentLinkedQueue" onclick="javascript:window.open(&#39;http://www.infoq.com/cn/articles/ConcurrentLinkedQueue&#39;); return false;">http://www.infoq.com/cn/articles/ConcurrentLinkedQueue</a></p>
<h2>1.&nbsp;&nbsp;&nbsp; 引言</h2>
<p>在并发编程中我们有时候需要使用线程安全的队列。如果我们要实现一个线程安全的队列有两种实现方式一种是使用阻塞算法，另一种是使用非阻塞算法。使用阻塞算法的队列可以用一个锁（入队和出队用同一把锁）或两个锁（入队和出队用不同的锁）等方式来实现，而非阻塞的实现方式则可以使用循环CAS的方式来实现，本文让我们一起来研究下Doug Lea是如何使用非阻塞的方式来实现线程安全队列ConcurrentLinkedQueue的，相信从大师身上我们能学到不少并发编程的技巧。<br>
<span id="more-1541"></span></p>
<h2>2.&nbsp;&nbsp;&nbsp; ConcurrentLinkedQueue的介绍</h2>
<p align="left">ConcurrentLinkedQueue是一个基于链接节点的无界线程安全队列，它采用先进先出的规则对节点进行排序，当我们添加一个元素的时候，它会添加到队列的尾部，当我们获取一个元素时，它会返回队列头部的元素。它采用了“wait－free”算法来实现，该算法在Michael &amp; Scott算法上进行了一些修改, Michael &amp; Scott算法的详细信息可以参见<a href="http://www.cs.rochester.edu/u/michael/PODC96.html" onclick="javascript:window.open(&#39;http://www.cs.rochester.edu/u/michael/PODC96.html&#39;); return false;">参考资料一</a>。</p>
<h2>3.&nbsp;&nbsp;&nbsp; ConcurrentLinkedQueue的结构</h2>
<p>我们通过ConcurrentLinkedQueue的类图来分析一下它的结构。</p>
<p><a href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/ConcurrentLinkedQueue类图.jpg"><img class="alignnone size-full wp-image-1543" alt="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/ConcurrentLinkedQueue类图.jpg" width="832" height="436"></a></p>
<p align="center">（图1）</p>
<p align="left">&nbsp;&nbsp;&nbsp;&nbsp; ConcurrentLinkedQueue由head节点和tair节点组成，每个节点（Node）由节点元素（item）和指向下一个节点的引用(next)组成，节点与节点之间就是通过这个next关联起来，从而组成一张链表结构的队列。默认情况下head节点存储的元素为空，tair节点等于head节点。</p>
<div id="highlighter_104981" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://ifeve.com/concurrentlinkedqueue/#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_104981_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_104981" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://ifeve.com/concurrentlinkedqueue/#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="http://ifeve.com/concurrentlinkedqueue/#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword">private</code> <code class="keyword">transient</code> <code class="keyword">volatile</code> <code class="plain">Node&lt;e&gt; tail = head;</code></td></tr></tbody></table></div></div></div>
<h2>4.&nbsp;&nbsp;&nbsp; 入队列</h2>
<p align="left"><b>入队列就是将入队节点添加到队列的尾部</b>。为了方便理解入队时队列的变化，以及head节点和tair节点的变化，每添加一个节点我就做了一个队列的快照图。</p>
<p align="left"><a href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/ConcurrentLinekedQueue队列入队结构变化图.jpg"><img class="alignnone size-full wp-image-1545" alt="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/ConcurrentLinekedQueue队列入队结构变化图.jpg" width="656" height="386"></a></p>
<p align="center">（图二）</p>
<ul>
<li>第一步添加元素1。队列更新head节点的next节点为元素1节点。又因为tail节点默认情况下等于head节点，所以它们的next节点都指向元素1节点。</li>
<li>第二步添加元素2。队列首先设置元素1节点的next节点为元素2节点，然后更新tail节点指向元素2节点。</li>
<li>第三步添加元素3，设置tail节点的next节点为元素3节点。</li>
<li>第四步添加元素4，设置元素3的next节点为元素4节点，然后将tail节点指向元素4节点。</li>
</ul>
<p align="left">通过debug入队过程并观察head节点和tail节点的变化，发现入队主要做两件事情，第一是将入队节点设置成当前队列尾节点的下一个节点。第二是更新tail节点，如果tail节点的next节点不为空，则将入队节点设置成tail节点，如果tail节点的next节点为空，则将入队节点设置成tail的next节点，所以tail节点不总是尾节点，理解这一点对于我们研究源码会非常有帮助。</p>
<p align="left">上面的分析让我们从单线程入队的角度来理解入队过程，但是多个线程同时进行入队情况就变得更加复杂，因为可能会出现其他线程插队的情况。如果有一个线程正在入队，那么它必须先获取尾节点，然后设置尾节点的下一个节点为入队节点，但这时可能有另外一个线程插队了，那么队列的尾节点就会发生变化，这时当前线程要暂停入队操作，然后重新获取尾节点。让我们再通过源码来详细分析下它是如何使用CAS算法来入队的。</p>
<div id="highlighter_858630" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://ifeve.com/concurrentlinkedqueue/#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_858630_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_858630" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://ifeve.com/concurrentlinkedqueue/#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="http://ifeve.com/concurrentlinkedqueue/#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword">public</code> <code class="keyword">boolean</code> <code class="plain">offer(E e) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(e == </code><code class="keyword">null</code><code class="plain">) </code><code class="keyword">throw</code> <code class="keyword">new</code> <code class="plain">NullPointerException();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//入队前，创建一个入队节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; n = </code><code class="keyword">new</code> <code class="plain">Node&lt;/e&gt;&lt;e&gt;(e);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">retry:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//死循环，入队不成功反复入队。</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">for</code> <code class="plain">(;;) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//创建一个指向tail节点的引用</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; t = tail;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//p用来表示队列的尾节点，默认情况下等于tail节点。</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; p = t;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">for</code> <code class="plain">(</code><code class="keyword">int</code> <code class="plain">hops = </code><code class="value">0</code><code class="plain">; ; hops++) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//获得p节点的下一个节点。</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; next = succ(p);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//next节点不为空，说明p不是尾节点，需要更新p后在将它指向next节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(next != </code><code class="keyword">null</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//循环了两次及其以上，并且当前节点还是不等于尾节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(hops &gt; HOPS &amp;&amp; t != tail)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">continue</code> <code class="plain">retry;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">p = next;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//如果p是尾节点，则设置p节点的next节点为入队节点。</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">else</code> <code class="keyword">if</code> <code class="plain">(p.casNext(</code><code class="keyword">null</code><code class="plain">, n)) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//如果tail节点有大于等于1个next节点，则将入队节点设置成tair节点，更新失败了也没关系，因为失败了表示有其他线程成功更新了tair节点。</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content"><code class="keyword">if</code> <code class="plain">(hops &gt;= HOPS)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">casTail(t, n); </code><code class="comments">// 更新tail节点，允许失败</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="keyword">true</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// p有next节点,表示p的next节点是尾节点，则重新设置p节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>59</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">else</code> <code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>60</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>61</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">p = succ(p);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>62</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>63</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>64</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>65</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>66</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>67</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>68</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>69</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p><b>从源代码角度来看整个入队过程主要做二件事情。</b>第一是定位出尾节点，第二是使用CAS算法能将入队节点设置成尾节点的next节点，如不成功则重试。</p>
<p><b>第一步定位尾节点。</b>tail节点并不总是尾节点，所以每次入队都必须先通过tail节点来找到尾节点，尾节点可能就是tail节点，也可能是tail节点的next节点。代码中循环体中的第一个if就是判断tail是否有next节点，有则表示next节点可能是尾节点。获取tail节点的next节点需要注意的是p节点等于p的next节点的情况，只有一种可能就是p节点和p的next节点都等于空，表示这个队列刚初始化，正准备添加第一次节点，所以需要返回head节点。获取p节点的next节点代码如下</p>
<div id="highlighter_79439" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://ifeve.com/concurrentlinkedqueue/#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_79439_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_79439" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://ifeve.com/concurrentlinkedqueue/#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="http://ifeve.com/concurrentlinkedqueue/#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword">final</code> <code class="plain">Node&lt;/e&gt;&lt;e&gt; succ(Node&lt;/e&gt;&lt;e&gt; p) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; next = p.getNext();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">(p == next) ? head : next;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p><b>第二步设置入队节点为尾节点</b>。p.casNext(<b>null</b>, n)方法用于将入队节点设置为当前队列尾节点的next节点，p如果是null表示p是当前队列的尾节点，如果不为null表示有其他线程更新了尾节点，则需要重新获取当前队列的尾节点。</p>
<p><b>hops</b><b>的设计意图</b>。上面分析过对于先进先出的队列入队所要做的事情就是将入队节点设置成尾节点，doug lea写的代码和逻辑还是稍微有点复杂。那么我用以下方式来实现行不行？</p>
<div id="highlighter_489954" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://ifeve.com/concurrentlinkedqueue/#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_489954_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_489954" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://ifeve.com/concurrentlinkedqueue/#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="http://ifeve.com/concurrentlinkedqueue/#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword">public</code> <code class="keyword">boolean</code> <code class="plain">offer(E e) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(e == </code><code class="keyword">null</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">throw</code> <code class="keyword">new</code> <code class="plain">NullPointerException();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; n = </code><code class="keyword">new</code> <code class="plain">Node&lt;/e&gt;&lt;e&gt;(e);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">for</code> <code class="plain">(;;) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; t = tail;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(t.casNext(</code><code class="keyword">null</code><code class="plain">, n) &amp;&amp; casTail(t, n)) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="keyword">true</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p>让tail节点永远作为队列的尾节点，这样实现代码量非常少，而且逻辑非常清楚和易懂。但是这么做有个缺点就是每次都需要使用循环CAS更新tail节点。如果能减少CAS更新tail节点的次数，就能提高入队的效率，所以doug lea使用hops变量来控制并减少tail节点的更新频率，并不是每次节点入队后都将 tail节点更新成尾节点，而是当 tail节点和尾节点的距离大于等于常量HOPS的值（默认等于1）时才更新tail节点，tail和尾节点的距离越长使用CAS更新tail节点的次数就会越少，但是距离越长带来的负面效果就是每次入队时定位尾节点的时间就越长，因为循环体需要多循环一次来定位出尾节点，但是这样仍然能提高入队的效率，因为从本质上来看它通过增加对volatile变量的读操作来减少了对volatile变量的写操作，而对volatile变量的写操作开销要远远大于读操作，所以入队效率会有所提升。</p>
<div id="highlighter_720433" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://ifeve.com/concurrentlinkedqueue/#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_720433_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_720433" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://ifeve.com/concurrentlinkedqueue/#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="http://ifeve.com/concurrentlinkedqueue/#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword">private</code> <code class="keyword">static</code> <code class="keyword">final</code> <code class="keyword">int</code> <code class="plain">HOPS = </code><code class="value">1</code><code class="plain">;</code></td></tr></tbody></table></div></div></div>
<p>还有一点需要注意的是入队方法永远返回true，所以不要通过返回值判断入队是否成功。</p>
<h2>5.&nbsp;&nbsp;&nbsp; 出队列</h2>
<p><b>&nbsp; &nbsp; </b>出队列的就是<b>从队列里返回一个节点元素</b>，并清空该节点对元素的引用。让我们通过每个节点出队的快照来观察下head节点的变化。</p>
<p style="text-align: center;"><img class="size-full wp-image-10253 aligncenter" alt="出队列" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/出队列.jpg" width="500" height="340"></p>
<p>从上图可知，并不是每次出队时都更新head节点，当head节点里有元素时，直接弹出head节点里的元素，而不会更新head节点。只有当head节点里没有元素时，出队操作才会更新head节点。这种做法也是通过hops变量来减少使用CAS更新head节点的消耗，从而提高出队效率。让我们再通过源码来深入分析下出队过程。</p>
<div id="highlighter_460038" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://ifeve.com/concurrentlinkedqueue/#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_460038_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_460038" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://ifeve.com/concurrentlinkedqueue/#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="http://ifeve.com/concurrentlinkedqueue/#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword">public</code> <code class="plain">E poll() {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; h = head;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// p表示头节点，需要出队的节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; p = h;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">for</code> <code class="plain">(</code><code class="keyword">int</code> <code class="plain">hops = </code><code class="value">0</code><code class="plain">;; hops++) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// 获取p节点的元素</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">E item = p.getItem();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// 如果p节点的元素不为空，使用CAS设置p节点引用的元素为null,如果成功则返回p节点的元素。</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(item != </code><code class="keyword">null</code> <code class="plain">&amp;&amp; p.casItem(item, </code><code class="keyword">null</code><code class="plain">)) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(hops &gt;= HOPS) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//将p节点下一个节点设置成head节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; q = p.getNext();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">updateHead(h, (q != </code><code class="keyword">null</code><code class="plain">) ? q : p);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">item;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// 如果头节点的元素为空或头节点发生了变化，这说明头节点已经被另外一个线程修改了。那么获取p节点的下一个节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Node&lt;/e&gt;&lt;e&gt; next = succ(p);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// 如果p的下一个节点也为空，说明这个队列已经空了</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(next == </code><code class="keyword">null</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// 更新头节点。</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">updateHead(h, p);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// 如果下一个元素不为空，则将头节点的下一个节点设置成头节点</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">p = next;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="keyword">null</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p>首先获取头节点的元素，然后判断头节点元素是否为空，如果为空，表示另外一个线程已经进行了一次出队操作将该节点的元素取走，如果不为空，则使用CAS的方式将头节点的引用设置成null，如果CAS成功，则直接返回头节点的元素，如果不成功，表示另外一个线程已经进行了一次出队操作更新了head节点，导致元素发生了变化，需要重新获取头节点。</p>
<h2>6.&nbsp;&nbsp;&nbsp; 参考资料</h2>
<ul>
<li><a href="http://www.cs.rochester.edu/u/scott/papers/1996_PODC_queues.pdf" onclick="javascript:window.open(&#39;http://www.cs.rochester.edu/u/scott/papers/1996_PODC_queues.pdf&#39;); return false;">简单，快速和实用的阻塞和非阻塞并发队列算法</a>。</li>
<li><a href="http://www.ibm.com/developerworks/cn/java/j-lo-concurrent/index.html" onclick="javascript:window.open(&#39;http://www.ibm.com/developerworks/cn/java/j-lo-concurrent/index.html&#39;); return false;">非阻塞算法在容器里的实现</a>。</li>
<li>JDK1.6中ConcurrentLinkedQueue源码和注释。</li>
</ul>
<p>
</p><div style="margin-top: 15px; font-style: italic">
<p><strong>原创文章，转载请注明：</strong> 转载自<a href="http://ifeve.com/">并发编程网 – ifeve.com</a></p>
<p><strong>本文链接地址:</strong> <a href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/聊聊并发（六）ConcurrentLinkedQueue的实现原理分析.html">聊聊并发（六）ConcurrentLinkedQueue的实现原理分析</a></p>
</div>
<p style="margin-top: 0; margin-bottom: 15px; color: #888888; font-size: 80%; font-style: italic">文章的脚注信息由WordPress的<a href="http://easwy.com/blog/wordpress/wp-posturl/" style="color: #8888FF; text-decoration: underline;" onclick="javascript:window.open(&#39;http://easwy.com/blog/wordpress/wp-posturl/&#39;); return false;">wp-posturl插件</a>自动生成</p>
<div style="clear:both; margin-top:5px; margin-bottom:5px;"></div><div style="float:left"><!-- JiaThis Button BEGIN -->
<div id="jiathis_style_32x32">
	<a class="jiathis_button_qzone" title="分享到QQ空间"><span class="jiathis_txt jtico jtico_qzone"></span></a>
	<a class="jiathis_button_tsina" title="分享到新浪微博"><span class="jiathis_txt jtico jtico_tsina"></span></a>
	<a class="jiathis_button_tqq" title="分享到腾讯微博"><span class="jiathis_txt jtico jtico_tqq"></span></a>
	<a class="jiathis_button_renren" title="分享到人人网"><span class="jiathis_txt jtico jtico_renren"></span></a>
	<a class="jiathis_button_kaixin001" title="分享到开心网"><span class="jiathis_txt jtico jtico_kaixin001"></span></a>
	<a href="http://www.jiathis.com/share/" class="jiathis jiathis_txt jtico jtico_jiathis" onclick="javascript:window.open(&#39;http://www.jiathis.com/share/&#39;); return false;"></a>
	<a class="jiathis_counter_style"><span class="jiathis_button_expanded jiathis_counter jiathis_bubble_style" id="jiathis_counter_71" title="累计分享2次">2</span></a>
</div>
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jia.js" charset="utf-8"></script><script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/plugin.client.js" charset="utf-8"></script>
<!-- JiaThis Button END --></div><div style="clear:both; margin-top:5px; margin-bottom:5px;"></div>
                         <div class="abh_box abh_box_down abh_box_business"><ul class="abh_tabs"> <li class="abh_about abh_active"><a href="http://ifeve.com/concurrentlinkedqueue/#abh_about">About</a></li> <li class="abh_posts"><a href="http://ifeve.com/concurrentlinkedqueue/#abh_posts">Latest Posts</a></li></ul><div class="abh_tab_content"><section class="vcard abh_about_tab abh_tab" style="display:block"><div class="abh_image"><a href="http://weibo.com/kirals" class="url" title="方 腾飞" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;"><img alt="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/a21e2b8f4893347e62eeca7597f04ebc" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></a></div><div class="abh_social"> </div><div class="abh_text"><h3 class="fn name"><a href="http://weibo.com/kirals" class="url" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;">方 腾飞</a></h3><div class="abh_job"></div><div class="description note abh_description">花名清英，并发网创始人，蚂蚁金服技术专家。目前工作于支付宝微贷事业部，关注互联网金融，并发编程和敏捷实践。</div></div> </section><section class="abh_posts_tab abh_tab"><div class="abh_image"><a href="http://weibo.com/kirals" class="url" title="方 腾飞" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;"><img alt="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/a21e2b8f4893347e62eeca7597f04ebc" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></a></div><div class="abh_social"> </div><div class="abh_text"><h4>Latest posts by 方 腾飞 <span class="abh_allposts">(<a href="http://ifeve.com/author/admin/">see all</a>)</span></h4><div class="abh_description note"><ul>				<li>					<a href="http://ifeve.com/ali-think-12/">阿里感悟（十一）如何准备面试</a><span> - 2015 年 10 月 6 日</span>				</li>				<li>					<a href="http://ifeve.com/think-in-ali-10/">阿里感悟（十）如何写好简历</a><span> - 2015 年 10 月 6 日</span>				</li>				<li>					<a href="http://ifeve.com/zookeeper-apache/">《ZooKeeper官方指南》翻译邀请</a><span> - 2015 年 10 月 5 日</span>				</li></ul></div></div> </section></div> </div><div class="yarpp-related">
<h3>Related posts:</h3><ol>
<li><a href="http://ifeve.com/volatile/" rel="bookmark" title="聊聊并发（一）深入分析Volatile的实现原理">聊聊并发（一）深入分析Volatile的实现原理 </a></li>
<li><a href="http://ifeve.com/java-blocking-queue/" rel="bookmark" title="聊聊并发（七）——Java中的阻塞队列">聊聊并发（七）——Java中的阻塞队列 </a></li>
<li><a href="http://ifeve.com/java-copy-on-write/" rel="bookmark" title="聊聊并发-Java中的Copy-On-Write容器">聊聊并发-Java中的Copy-On-Write容器 </a></li>
<li><a href="http://ifeve.com/producers-and-consumers-mode/" rel="bookmark" title="聊聊并发（十）生产者消费者模式">聊聊并发（十）生产者消费者模式 </a></li>
<li><a href="http://ifeve.com/talk-concurrency-forkjoin/" rel="bookmark" title="聊聊并发（八）——Fork/Join框架介绍">聊聊并发（八）——Fork/Join框架介绍 </a></li>
<li><a href="http://ifeve.com/concurrenthashmap/" rel="bookmark" title="聊聊并发（四）深入分析ConcurrentHashMap">聊聊并发（四）深入分析ConcurrentHashMap </a></li>
<li><a href="http://ifeve.com/atomic-operation/" rel="bookmark" title="聊聊并发（五）原子操作的实现原理">聊聊并发（五）原子操作的实现原理 </a></li>
<li><a href="http://ifeve.com/no-blicking-do-1/" rel="bookmark" title="非阻塞同步算法实战（一）">非阻塞同步算法实战（一） </a></li>
<li><a href="http://ifeve.com/java-threadpool/" rel="bookmark" title="聊聊并发（三）Java线程池的分析和使用">聊聊并发（三）Java线程池的分析和使用 </a></li>
<li><a href="http://ifeve.com/java-synchronized/" rel="bookmark" title="聊聊并发（二）Java SE1.6中的Synchronized">聊聊并发（二）Java SE1.6中的Synchronized </a></li>
<li><a href="http://ifeve.com/java-synchronousqueue/" rel="bookmark" title="Java并发包中的同步队列SynchronousQueue实现原理">Java并发包中的同步队列SynchronousQueue实现原理 </a></li>
<li><a href="http://ifeve.com/juc-linkedblockingqueue/" rel="bookmark" title="JUC LinkedBlockingQueue">JUC LinkedBlockingQueue </a></li>
<li><a href="http://ifeve.com/buglinkedtransferqueue-bug/" rel="bookmark" title="Bug:LinkedTransferQueue的数据暂失和CPU爆满以及修复">Bug:LinkedTransferQueue的数据暂失和CPU爆满以及修复 </a></li>
<li><a href="http://ifeve.com/java_lock_see2/" rel="bookmark" title="Java锁的种类以及辨析（二）：自旋锁的其他种类">Java锁的种类以及辨析（二）：自旋锁的其他种类 </a></li>
<li><a href="http://ifeve.com/java_lock_see3/" rel="bookmark" title="Java锁的种类以及辨析（三）：阻塞锁">Java锁的种类以及辨析（三）：阻塞锁 </a></li>
</ol>
</div>
           </div><!-- END .post_content -->
    </div>
    <div class="meta">
          <ul>
      <li class="post_date clearfix">
       <span class="date">12</span>
       <span class="month">Jan</span>
       <span class="year">2013</span>
      </li>
      
<li class="post_comment">
6,878 人阅读</li>

      <li class="post_author"><a href="http://ifeve.com/author/admin/" title="由方 腾飞发布" rel="author">方 腾飞</a></li>      <li class="post_category"><a href="http://ifeve.com/category/talk-concurrent/" rel="category tag">本站原创</a></li>       <li class="post_category"><div id="post-ratings-1541" class="post-ratings" itemscope="" itemtype="http://schema.org/Article" data-nonce="a414161b3e"><img id="rating_1541_1" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/rating_on.gif" alt="好烂啊" title="好烂啊" onmouseover="current_rating(1541, 1, &#39;好烂啊&#39;);" onmouseout="ratings_off(3, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1541_2" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/rating_on.gif" alt="没价值" title="没价值" onmouseover="current_rating(1541, 2, &#39;没价值&#39;);" onmouseout="ratings_off(3, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1541_3" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/rating_on.gif" alt="凑合看看" title="凑合看看" onmouseover="current_rating(1541, 3, &#39;凑合看看&#39;);" onmouseout="ratings_off(3, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1541_4" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/rating_off.gif" alt="还不错" title="还不错" onmouseover="current_rating(1541, 4, &#39;还不错&#39;);" onmouseout="ratings_off(3, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"><img id="rating_1541_5" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/rating_off.gif" alt="超赞" title="超赞" onmouseover="current_rating(1541, 5, &#39;超赞&#39;);" onmouseout="ratings_off(3, 0, 0);" onclick="rate_post();" onkeypress="rate_post();" style="cursor: pointer; border: 0px;"> (<strong>2</strong> votes, average: <strong>3.00</strong> out of 5)<br><span class="post-ratings-text" id="ratings_1541_text"></span><meta itemprop="headline" content="聊聊并发（六）ConcurrentLinkedQueue的实现原理分析"><meta itemprop="description" content="本文是作者原创，首发于InfoQ：http://www.infoq.com/cn/articles/ConcurrentLinkedQueue
1.    引言
在并发编程中我们有时候需要使用线程安全的队列。如果我们要实现一个线程安全的队列有两种实现方式一种是使用阻塞算法，另一种是使用非阻塞算法。使用阻塞算法的队列可以用一个锁（入队和出队用同一把锁）或两个锁（入队和出队用不同的锁）等方式来实现..."><meta itemprop="datePublished" content="2013-01-12T20:06:41+00:00"><meta itemprop="url" content="http://ifeve.com/concurrentlinkedqueue/"><div style="display: none;" itemprop="aggregateRating" itemscope="" itemtype="http://schema.org/AggregateRating"><meta itemprop="bestRating" content="5"><meta itemprop="worstRating" content="1"><meta itemprop="ratingValue" content="3"><meta itemprop="ratingCount" content="2"></div></div><div id="post-ratings-1541-loading" class="post-ratings-loading">
			<img src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/loading.gif" width="16" height="16" alt="Loading..." title="Loading..." class="post-ratings-image">Loading...</div></li>       <li class="post_comment"><a href="http://ifeve.com/concurrentlinkedqueue/#comments">3 条评论</a></li>           </ul>
         </div>
   </div><!-- END .post_wrap -->

   
      <div id="comments_wrapper">
    




<div id="comment_header" class="clearfix">

 <ul id="comment_header_left">
  <li id="add_comment"><a href="http://ifeve.com/concurrentlinkedqueue/#respond">发表评论</a></li>
  <li id="comment_feed"><a href="http://ifeve.com/comments/feed/" title="RSS订阅评论">RSS订阅评论</a></li>
 </ul>

 <ul id="comment_header_right">
   <li id="trackback_closed">Trackback 关闭</li>
   <li id="comment_closed">评论 (3)</li>
 </ul>


</div><!-- END #comment_header -->

<div id="comments">

 <div id="comment_area">
  <!-- start commnet -->
  <ol class="commentlist">
	
 <li class="comment guest-comment" id="comment-55">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/325438c0ceacb2e064234c7a3756a88d" srcset="http://gravatar0.233.wiki/avatar/325438c0ceacb2e064234c7a3756a88d?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-55" class="url guest-url" href="http://demi-panda.com/" rel="external nofollow" onclick="javascript:window.open(&#39;http://demi-panda.com/&#39;); return false;">

熊猫家族
</a>
     </li>
     <li class="comment-date">2013/01/16 9:46上午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fconcurrentlinkedqueue%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-55&#39;, &#39;comment-55&#39;, &#39;comment-content-55&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-55">
    <p>分析的很详细  学习啦</p>
  </div>

</li><!-- #comment-## -->

 <li class="comment guest-comment" id="comment-1305">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/3866db83da7f5fdbf290a13b37fb43d1" srcset="http://gravatar0.233.wiki/avatar/3866db83da7f5fdbf290a13b37fb43d1?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-1305" class="url guest-url" href="http://www.cnblogs.com/trytocatch/" rel="external nofollow" onclick="javascript:window.open(&#39;http://www.cnblogs.com/trytocatch/&#39;); return false;">

trytocatch
</a>
     </li>
     <li class="comment-date">2013/06/02 1:57上午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fconcurrentlinkedqueue%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-1305&#39;, &#39;comment-1305&#39;, &#39;comment-content-1305&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-1305">
    <p>想请教个问题，为什么大家说这是wait-free的？<br>
wait-free的定义是：程序可以在有限步之内结束，而不管其它线程的相对速度如何。<br>
但是，例如：某线程执行offer操作，同时有很多线程也执行offer，导致该线程一直CAS（p.casNext(null, n)失败），那么该线程无法保证在有限步内结束，我觉得这里更像是lock-free，因为它只保证了，总有一个线程成功了，整体在推进</p>
  </div>

<ul class="children">

 <li class="comment admin-comment" id="comment-1307">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img alt="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/a21e2b8f4893347e62eeca7597f04ebc(1)" srcset="http://gravatar0.233.wiki/avatar/a21e2b8f4893347e62eeca7597f04ebc?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35">  
    <ul class="comment-name-date">
     <li class="comment-name">
<a id="commentauthor-1307" class="url admin-url" href="http://weibo.com/kirals" rel="external nofollow" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;">

方 腾飞
</a>
     </li>
     <li class="comment-date">2013/06/02 11:44下午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-login" href="http://ifeve.com/wp-login.php?redirect_to=http%3A%2F%2Fifeve.com%2Fconcurrentlinkedqueue%2F">登录以回复</a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-1307&#39;, &#39;comment-1307&#39;, &#39;comment-content-1307&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-1307">
    <p>好问题。我是参考了<a href="http://www.cjsdn.net/doc/jdk60/java/util/concurrent/ConcurrentLinkedQueue.html" rel="nofollow" onclick="javascript:window.open(&#39;http://www.cjsdn.net/doc/jdk60/java/util/concurrent/ConcurrentLinkedQueue.html&#39;); return false;">JDK的API文档</a>。更详细的解释可以参考＝》http://rethinkdb.com/blog/lock-free-vs-wait-free-concurrency/，有兴趣的话可以翻译出来在并发网发表。</p>
  </div>

</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
  </ol>
  <!-- comments END -->

  
 </div><!-- #comment-list END -->


 <div id="trackback_area">
 <!-- start trackback -->
  <!-- trackback end -->
 </div><!-- #trackbacklist END -->

 


 
 <div class="comment_form_wrapper" id="respond">
    您必须 <a href="http://ifeve.com/wp-login.php">登陆</a> 后才能发表评论 </div>

 </div><!-- #comment end -->   </div>
   
      <div id="previous_next_post_single">
    <div class="clearfix">
     <p id="previous_post"><a href="http://ifeve.com/java-concurrent-animated/" rel="prev">看动画学并发编程</a></p>     <p id="next_post"><a href="http://ifeve.com/transation-plan-2/" rel="next">并发译文翻译计划（二）</a></p>    </div>
   </div>
   

  </div><!-- END #left_col -->

  <div id="container"></div>

    <div id="right_col">
   

<div class="side_box clearfix" id="side_meta_content">

  <ul id="social_link" class="clearfix">
    <li class="rss_button"><a class="target_blank" href="http://ifeve.com/feed/">rss</a></li>
       </ul>
 
  <div id="search_area">
    <form method="get" id="searchform" action="http://ifeve.com/">
   <div><input id="search_button" class="rollover" type="image" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/search_button.gif" alt="搜索一下" title="搜索一下"></div>
   <div><input id="search_input" type="text" value="搜索一下" name="s" onfocus="if (this.value == &#39;搜索一下&#39;) this.value = &#39;&#39;;" onblur="if (this.value == &#39;&#39;) this.value = &#39;搜索一下&#39;;"></div>
  </form>
   </div>
 
</div>


<div id="side_top">

 <div class="side_box widget_text" id="text-17">
			<div class="textwidget"><!-- 请置于所有广告位代码之前 -->
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/m.js"></script>
<script type="text/javascript">
BAIDU_CLB_preloadSlots("980251","980252");
</script><script charset="utf-8" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/ecom"></script>
<!-- 广告位：右最上 -->
<script type="text/javascript">BAIDU_CLB_fillSlot("1063991");</script><div id="BAIDU_DUP_wrapper_1063991_0"></div><script charset="utf-8" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/ecom(1)"></script><script charset="utf-8" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/fixed7o.js"></script>

<p>购买<a href="http://s.click.taobao.com/nMgPIwx" onclick="javascript:window.open(&#39;http://s.click.taobao.com/nMgPIwx&#39;); return false;">《Java并发编程的艺术》</a>,UCloud提供云服务</p>

<!-- 广告位：首页右上1 -->
<script type="text/javascript">BAIDU_CLB_fillSlot("980251");</script><div id="BAIDU_DUP_wrapper_980251_0"><iframe id="baidu_clb_slot_iframe_980251_0" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/聊聊并发（六）ConcurrentLinkedQueue的实现原理分析.html" onload="BAIDU_DUP_CLB_renderFrame(&#39;980251_0&#39;)" width="300" height="80" vspace="0" hspace="0" allowtransparency="true" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border:0; vertical-align:bottom; margin:0; display:block;"></iframe></div>

<br>
<script language="javascript"> 
var randomNum = Math.round(Math.random()*2);
var image=new Array(3);
image[0]="http://ww4.sinaimg.cn/mw690/005NgQwbgw1evsy1m5y19j308c028747.jpg";
image[1]="http://ww2.sinaimg.cn/mw690/005NgQwbgw1evsy1kjd94j308c0283yh.jpg";
image[2]="http://ww1.sinaimg.cn/mw690/005NgQwbgw1evsy1iukeij308c028dfu.jpg";
var imageUrl=image[randomNum];
var urls=new Array(3);
urls[0]="http://yun.lu";
urls[1]="http://yun.lu";
urls[2]="http://yun.lu";
var url = urls[randomNum];
var adHTML = "<a href='"+url+"' target='_blank'><img src='"+imageUrl+"' border='0'></a>";
document.write(adHTML);
</script><a href="http://yun.lu/" onclick="javascript:window.open(&#39;http://yun.lu/&#39;); return false;"><img src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/005NgQwbgw1evsy1iukeij308c028dfu.jpg" border="0"></a>

<br>
<!-- 广告位：首页右上2 -->
<script type="text/javascript">BAIDU_CLB_fillSlot("980252");</script><div id="BAIDU_DUP_wrapper_980252_0"></div>
<script async="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="8872369516" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</div>
		<div class="side_box widget_recent_entries" id="recent-posts-2">
		<h3 class="side_title">近期文章</h3>
		<ul>
					<li>
				<a href="http://ifeve.com/ali-think-12/">阿里感悟（十一）如何准备面试</a>
						</li>
					<li>
				<a href="http://ifeve.com/dis-session-manager/">大型网站之分布式会话管理</a>
						</li>
					<li>
				<a href="http://ifeve.com/think-in-ali-10/">阿里感悟（十）如何写好简历</a>
						</li>
					<li>
				<a href="http://ifeve.com/zookeeper-apache/">《ZooKeeper官方指南》翻译邀请</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-dev-kit-working-with-collection/">《Groovy官方文档》Groovy开发套件-使用集合</a>
						</li>
					<li>
				<a href="http://ifeve.com/zookeeperover/">《Apache Zookeeper官方文档》2-综述</a>
						</li>
					<li>
				<a href="http://ifeve.com/json-code-problem/">JSON数据乱码问题</a>
						</li>
					<li>
				<a href="http://ifeve.com/apache-zookeeper-1/">《Apache zookeeper 官方文档》-1简介</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-guide/">《Groovy官方指南》目录</a>
						</li>
					<li>
				<a href="http://ifeve.com/java-io-%e4%b9%8b-outputstream%e6%ba%90%e7%a0%81/">Java IO 之 OutputStream源码</a>
						</li>
					<li>
				<a href="http://ifeve.com/lru-cache/">使用Redis作为一个LRU缓存</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-syntax/">《Groovy语言规范》-语法</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-ides/">《Groovy官方文档》3.4 开发环境支持</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-dev-kit-io/">《Groovy官方文档》Groovy开发套件-使用IO</a>
						</li>
					<li>
				<a href="http://ifeve.com/how-to-navigatehow-to-navigate-and-make-progress/">Adopt Open JDK官方文档(二)如何使用导航和取得进步？</a>
						</li>
					<li>
				<a href="http://ifeve.com/java-io-%e4%b9%8b-inputstream%e6%ba%90%e7%a0%81/">Java IO 之 InputStream源码</a>
						</li>
					<li>
				<a href="http://ifeve.com/static-factory-methods-vs-traditional-constructors/">静态工厂方法VS构造器</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-and-java/">《Groovy官方文档》1.3 Groovy和Java比较</a>
						</li>
					<li>
				<a href="http://ifeve.com/install-groovy/">《Groovy官方文档》1.2安装Groovy</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy-download/">《Groovy官方文档》1.1 下载Groovy</a>
						</li>
					<li>
				<a href="http://ifeve.com/fault-tolerance/">容错技术介绍</a>
						</li>
					<li>
				<a href="http://ifeve.com/groovy/">《Groovy官方指南》翻译邀请</a>
						</li>
					<li>
				<a href="http://ifeve.com/httpifeve-comvelocity-guide-summary/">Apache Velocity官方指南-总结</a>
						</li>
					<li>
				<a href="http://ifeve.com/java8/">Java8简明指南</a>
						</li>
					<li>
				<a href="http://ifeve.com/adopt-open-jd-10/">Adopt Open JDK官方文档（十）</a>
						</li>
					<li>
				<a href="http://ifeve.com/lock-reentrantlock/">《Java并发编程从入门到精通》显示锁Lock和ReentrantLock</a>
						</li>
					<li>
				<a href="http://ifeve.com/apache-storm/">Apache Storm 官方文档中文版</a>
						</li>
					<li>
				<a href="http://ifeve.com/storm-internal-implementation/">Apache Storm 官方文档 —— 内部技术实现</a>
						</li>
					<li>
				<a href="http://ifeve.com/java-concurrency-thread-safe/">《 Java并发编程从入门到精通》Thread安全与不安全</a>
						</li>
					<li>
				<a href="http://ifeve.com/storm-acking-framework-implementation/">Apache Storm 官方文档 —— Ack 框架的实现</a>
						</li>
				</ul>
		</div>
<div class="side_box widget_text" id="text-10">
			<div class="textwidget"><script async="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/adsbygoogle.js"></script>
<!-- 首页－右上－2 -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="8872369516" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</div>
<div class="side_box widget_views" id="views-4">
<h3 class="side_title">热门文章</h3>
<ul>
<li><a href="http://ifeve.com/google-guava/" title="Google Guava官方教程（中文版）">Google Guava官方教程（中文版）</a> 173,957 人阅读 </li><li><a href="http://ifeve.com/overview/" title="Java NIO系列教程（一） Java NIO 概述">Java NIO系列教程（一） Java NIO 概述</a> 99,608 人阅读 </li><li><a href="http://ifeve.com/java-concurrency-thread-directory/" title="Java并发性和多线程介绍目录">Java并发性和多线程介绍目录</a> 79,140 人阅读 </li><li><a href="http://ifeve.com/java-nio-all/" title="Java NIO 系列教程">Java NIO 系列教程</a> 76,783 人阅读 </li><li><a href="http://ifeve.com/java-nio-vs-io/" title="Java NIO系列教程（十二） Java NIO与IO">Java NIO系列教程（十二） Java NIO与IO</a> 70,126 人阅读 </li><li><a href="http://ifeve.com/java-7-concurrency-cookbook/" title="Java 7 并发编程指南中文版">Java 7 并发编程指南中文版</a> 59,101 人阅读 </li><li><a href="http://ifeve.com/selectors/" title="Java NIO系列教程（六） Selector">Java NIO系列教程（六） Selector</a> 57,665 人阅读 </li><li><a href="http://ifeve.com/channels/" title="Java NIO系列教程（二） Channel">Java NIO系列教程（二） Channel</a> 52,742 人阅读 </li><li><a href="http://ifeve.com/buffers/" title="Java NIO系列教程（三） Buffer">Java NIO系列教程（三） Buffer</a> 51,999 人阅读 </li><li><a href="http://ifeve.com/getting-started-with-stom-index/" title="《Storm入门》中文版">《Storm入门》中文版</a> 45,582 人阅读 </li><li><a href="http://ifeve.com/netty5-user-guide/" title="Netty 5用户指南">Netty 5用户指南</a> 42,230 人阅读 </li><li><a href="http://ifeve.com/disruptor/" title="并发框架Disruptor译文">并发框架Disruptor译文</a> 40,519 人阅读 </li><li><a href="http://ifeve.com/locks-are-bad/" title="剖析Disruptor:为什么会这么快？(一)锁的缺点">剖析Disruptor:为什么会这么快？(一)锁的缺点</a> 39,406 人阅读 </li><li><a href="http://ifeve.com/socket-channel/" title="Java NIO系列教程（八） SocketChannel">Java NIO系列教程（八） SocketChannel</a> 35,959 人阅读 </li><li><a href="http://ifeve.com/perfbook/" title="《深入理解并行编程》中文版">《深入理解并行编程》中文版</a> 35,274 人阅读 </li><li><a href="http://ifeve.com/getting-started-with-storm-1/" title="Storm入门之第一章">Storm入门之第一章</a> 34,566 人阅读 </li><li><a href="http://ifeve.com/file-channel/" title="Java NIO系列教程（七） FileChannel">Java NIO系列教程（七） FileChannel</a> 33,101 人阅读 </li><li><a href="http://ifeve.com/netty1/" title="Netty源码解读（一）概述">Netty源码解读（一）概述</a> 29,929 人阅读 </li><li><a href="http://ifeve.com/google-guava-using-and-avoiding-null/" title="[Google Guava] 1.1-使用和避免null">[Google Guava] 1.1-使用和避免null</a> 29,819 人阅读 </li><li><a href="http://ifeve.com/java-concurrency-constructs/" title="Java并发结构">Java并发结构</a> 29,602 人阅读 </li></ul>
</div>
<div class="side_box widget_text" id="text-7">
			<div class="textwidget"><script async="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="4721371513" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</div>
		</div>
<div class="side_box widget_recent_comments" id="recent-comments-2">
<h3 class="side_title">近期评论</h3>
<ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">yangcheng33</span>发表在《<a href="http://ifeve.com/book/comment-page-1/#comment-26402">《Java并发编程的艺术》勘误和支持</a>》</li><li class="recentcomments"><span class="comment-author-link">yangcheng33</span>发表在《<a href="http://ifeve.com/book/comment-page-1/#comment-26401">《Java并发编程的艺术》勘误和支持</a>》</li><li class="recentcomments"><span class="comment-author-link">平僧</span>发表在《<a href="http://ifeve.com/java-io-network/comment-page-1/#comment-26400">Java IO: 网络</a>》</li><li class="recentcomments"><span class="comment-author-link">ashitaka</span>发表在《<a href="http://ifeve.com/introduce-abstractqueuedsynchronizer/comment-page-1/#comment-26399">AbstractQueuedSynchronizer的介绍和原理分析</a>》</li><li class="recentcomments"><span class="comment-author-link">qooge</span>发表在《<a href="http://ifeve.com/lru-cache/comment-page-1/#comment-26398">使用Redis作为一个LRU缓存</a>》</li><li class="recentcomments"><span class="comment-author-link">sososolo</span>发表在《<a href="http://ifeve.com/lru-cache/comment-page-1/#comment-26397">使用Redis作为一个LRU缓存</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;">方 腾飞</a></span>发表在《<a href="http://ifeve.com/adopt-openjdk-translate-plan/comment-page-1/#comment-26396">Adopt OpenJDK 翻译计划</a>》</li><li class="recentcomments"><span class="comment-author-link">王山山</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26395">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">q1505740617</span>发表在《<a href="http://ifeve.com/adopt-openjdk-translate-plan/comment-page-1/#comment-26394">Adopt OpenJDK 翻译计划</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26393">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">tomasxxoo</span>发表在《<a href="http://ifeve.com/apache-storm/comment-page-1/#comment-26392">Apache Storm 官方文档中文版</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;">方 腾飞</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26391">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;">方 腾飞</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26390">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26389">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://weibo.com/kirals" rel="external nofollow" class="url" onclick="javascript:window.open(&#39;http://weibo.com/kirals&#39;); return false;">方 腾飞</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26388">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26387">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link">JackWang</span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26386">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.jamespan.me/blog/" rel="external nofollow" class="url" onclick="javascript:window.open(&#39;http://www.jamespan.me/blog/&#39;); return false;">JamesPan</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26385">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.jamespan.me/blog/" rel="external nofollow" class="url" onclick="javascript:window.open(&#39;http://www.jamespan.me/blog/&#39;); return false;">JamesPan</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26384">《Groovy官方指南》翻译邀请</a>》</li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.jamespan.me/blog/" rel="external nofollow" class="url" onclick="javascript:window.open(&#39;http://www.jamespan.me/blog/&#39;); return false;">JamesPan</a></span>发表在《<a href="http://ifeve.com/groovy/comment-page-1/#comment-26383">《Groovy官方指南》翻译邀请</a>》</li></ul></div>
<div class="side_box widget_tag_cloud" id="tag_cloud-4">
<h3 class="side_title">标签</h3>
<div class="tagcloud"><a href="http://ifeve.com/tag/actor/" class="tag-link-226" title="17个话题" style="font-size: 13.572815533981pt;">actor</a>
<a href="http://ifeve.com/tag/basic/" class="tag-link-213" title="14个话题" style="font-size: 12.485436893204pt;">Basic</a>
<a href="http://ifeve.com/tag/book/" class="tag-link-243" title="7个话题" style="font-size: 8.6796116504854pt;">book</a>
<a href="http://ifeve.com/tag/cacheline/" class="tag-link-77" title="6个话题" style="font-size: 8pt;">cacheline</a>
<a href="http://ifeve.com/tag/classes/" class="tag-link-251" title="8个话题" style="font-size: 9.3592233009709pt;">classes</a>
<a href="http://ifeve.com/tag/collections/" class="tag-link-260" title="11个话题" style="font-size: 11.126213592233pt;">collections</a>
<a href="http://ifeve.com/tag/concurrency/" class="tag-link-111" title="66个话题" style="font-size: 21.320388349515pt;">concurrency</a>
<a href="http://ifeve.com/tag/concurrent/" class="tag-link-214" title="11个话题" style="font-size: 11.126213592233pt;">Concurrent</a>
<a href="http://ifeve.com/tag/concurrent-data-structure/" class="tag-link-322" title="13个话题" style="font-size: 12.077669902913pt;">concurrent data structure</a>
<a href="http://ifeve.com/tag/concurrenthashmap/" class="tag-link-61" title="6个话题" style="font-size: 8pt;">ConcurrentHashMap</a>
<a href="http://ifeve.com/tag/customizing/" class="tag-link-250" title="8个话题" style="font-size: 9.3592233009709pt;">Customizing</a>
<a href="http://ifeve.com/tag/date/" class="tag-link-505" title="7个话题" style="font-size: 8.6796116504854pt;">date</a>
<a href="http://ifeve.com/tag/executor/" class="tag-link-177" title="20个话题" style="font-size: 14.388349514563pt;">Executor</a>
<a href="http://ifeve.com/tag/executor-framework/" class="tag-link-231" title="17个话题" style="font-size: 13.572815533981pt;">Executor framework</a>
<a href="http://ifeve.com/tag/false-sharing/" class="tag-link-119" title="7个话题" style="font-size: 8.6796116504854pt;">False Sharing</a>
<a href="http://ifeve.com/tag/faq/" class="tag-link-39" title="13个话题" style="font-size: 12.077669902913pt;">faq</a>
<a href="http://ifeve.com/tag/fork/" class="tag-link-232" title="11个话题" style="font-size: 11.126213592233pt;">fork</a>
<a href="http://ifeve.com/tag/forkjoin/" class="tag-link-224" title="9个话题" style="font-size: 10.038834951456pt;">Fork/Join</a>
<a href="http://ifeve.com/tag/fork-join/" class="tag-link-53" title="8个话题" style="font-size: 9.3592233009709pt;">fork join</a>
<a href="http://ifeve.com/tag/framework/" class="tag-link-73" title="22个话题" style="font-size: 14.932038834951pt;">Framework</a>
<a href="http://ifeve.com/tag/functional-programming/" class="tag-link-460" title="9个话题" style="font-size: 10.038834951456pt;">Functional Programming</a>
<a href="http://ifeve.com/tag/guava/" class="tag-link-309" title="14个话题" style="font-size: 12.485436893204pt;">Guava</a>
<a href="http://ifeve.com/tag/io/" class="tag-link-129" title="26个话题" style="font-size: 15.883495145631pt;">IO</a>
<a href="http://ifeve.com/tag/java/" class="tag-link-69" title="74个话题" style="font-size: 22pt;">JAVA</a>
<a href="http://ifeve.com/tag/java8/" class="tag-link-342" title="10个话题" style="font-size: 10.582524271845pt;">java8</a>
<a href="http://ifeve.com/tag/jmm/" class="tag-link-31" title="31个话题" style="font-size: 16.970873786408pt;">jmm</a>
<a href="http://ifeve.com/tag/join/" class="tag-link-233" title="11个话题" style="font-size: 11.126213592233pt;">join</a>
<a href="http://ifeve.com/tag/jvm/" class="tag-link-127" title="16个话题" style="font-size: 13.165048543689pt;">JVM</a>
<a href="http://ifeve.com/tag/lock/" class="tag-link-17" title="23个话题" style="font-size: 15.203883495146pt;">lock</a>
<a href="http://ifeve.com/tag/memory-barriers/" class="tag-link-75" title="10个话题" style="font-size: 10.582524271845pt;">Memory Barriers</a>
<a href="http://ifeve.com/tag/netty/" class="tag-link-280" title="16个话题" style="font-size: 13.165048543689pt;">Netty</a>
<a href="http://ifeve.com/tag/nio/" class="tag-link-131" title="14个话题" style="font-size: 12.485436893204pt;">NIO</a>
<a href="http://ifeve.com/tag/oauth-2-0/" class="tag-link-380" title="8个话题" style="font-size: 9.3592233009709pt;">OAuth 2.0</a>
<a href="http://ifeve.com/tag/pattern-matching/" class="tag-link-167" title="8个话题" style="font-size: 9.3592233009709pt;">pattern-matching</a>
<a href="http://ifeve.com/tag/ringbuffer/" class="tag-link-91" title="7个话题" style="font-size: 8.6796116504854pt;">RingBuffer</a>
<a href="http://ifeve.com/tag/scala/" class="tag-link-166" title="22个话题" style="font-size: 14.932038834951pt;">Scala</a>
<a href="http://ifeve.com/tag/stm/" class="tag-link-199" title="12个话题" style="font-size: 11.533980582524pt;">stm</a>
<a href="http://ifeve.com/tag/storm/" class="tag-link-351" title="39个话题" style="font-size: 18.194174757282pt;">Storm</a>
<a href="http://ifeve.com/tag/synchronization/" class="tag-link-216" title="15个话题" style="font-size: 12.757281553398pt;">synchronization</a>
<a href="http://ifeve.com/tag/synchronized/" class="tag-link-15" title="10个话题" style="font-size: 10.582524271845pt;">Synchronized</a>
<a href="http://ifeve.com/tag/thread/" class="tag-link-11" title="41个话题" style="font-size: 18.466019417476pt;">thread</a>
<a href="http://ifeve.com/tag/time/" class="tag-link-506" title="7个话题" style="font-size: 8.6796116504854pt;">time</a>
<a href="http://ifeve.com/tag/tomcat/" class="tag-link-347" title="8个话题" style="font-size: 9.3592233009709pt;">tomcat</a>
<a href="http://ifeve.com/tag/volatile/" class="tag-link-25" title="11个话题" style="font-size: 11.126213592233pt;">volatile</a>
<a href="http://ifeve.com/tag/%e5%a4%9a%e7%ba%bf%e7%a8%8b/" class="tag-link-197" title="8个话题" style="font-size: 9.3592233009709pt;">多线程</a></div>
</div>
<div class="side_box widget_text" id="text-9">
			<div class="textwidget"><script async="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="6198104715" data-adsbygoogle-status="done"><ins id="aswift_3_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


</div>
		</div>
</div>
<div id="side_middle" class="clearfix">
 <div id="side_left">
  <div class="side_box_short widget_archive" id="archives-2">
<h3 class="side_title">文章归档</h3>
		<ul>
	<li><a href="http://ifeve.com/2015/10/">2015年十月</a>&nbsp;(8)</li>
	<li><a href="http://ifeve.com/2015/09/">2015年九月</a>&nbsp;(29)</li>
	<li><a href="http://ifeve.com/2015/08/">2015年八月</a>&nbsp;(44)</li>
	<li><a href="http://ifeve.com/2015/07/">2015年七月</a>&nbsp;(20)</li>
	<li><a href="http://ifeve.com/2015/06/">2015年六月</a>&nbsp;(21)</li>
	<li><a href="http://ifeve.com/2015/05/">2015年五月</a>&nbsp;(15)</li>
	<li><a href="http://ifeve.com/2015/04/">2015年四月</a>&nbsp;(27)</li>
	<li><a href="http://ifeve.com/2015/03/">2015年三月</a>&nbsp;(13)</li>
	<li><a href="http://ifeve.com/2015/02/">2015年二月</a>&nbsp;(11)</li>
	<li><a href="http://ifeve.com/2015/01/">2015年一月</a>&nbsp;(13)</li>
	<li><a href="http://ifeve.com/2014/12/">2014年十二月</a>&nbsp;(26)</li>
	<li><a href="http://ifeve.com/2014/11/">2014年十一月</a>&nbsp;(61)</li>
	<li><a href="http://ifeve.com/2014/10/">2014年十月</a>&nbsp;(33)</li>
	<li><a href="http://ifeve.com/2014/09/">2014年九月</a>&nbsp;(47)</li>
	<li><a href="http://ifeve.com/2014/08/">2014年八月</a>&nbsp;(27)</li>
	<li><a href="http://ifeve.com/2014/07/">2014年七月</a>&nbsp;(13)</li>
	<li><a href="http://ifeve.com/2014/06/">2014年六月</a>&nbsp;(32)</li>
	<li><a href="http://ifeve.com/2014/05/">2014年五月</a>&nbsp;(45)</li>
	<li><a href="http://ifeve.com/2014/04/">2014年四月</a>&nbsp;(41)</li>
	<li><a href="http://ifeve.com/2014/03/">2014年三月</a>&nbsp;(34)</li>
	<li><a href="http://ifeve.com/2014/02/">2014年二月</a>&nbsp;(38)</li>
	<li><a href="http://ifeve.com/2014/01/">2014年一月</a>&nbsp;(19)</li>
	<li><a href="http://ifeve.com/2013/12/">2013年十二月</a>&nbsp;(10)</li>
	<li><a href="http://ifeve.com/2013/11/">2013年十一月</a>&nbsp;(5)</li>
	<li><a href="http://ifeve.com/2013/10/">2013年十月</a>&nbsp;(20)</li>
	<li><a href="http://ifeve.com/2013/09/">2013年九月</a>&nbsp;(38)</li>
	<li><a href="http://ifeve.com/2013/08/">2013年八月</a>&nbsp;(48)</li>
	<li><a href="http://ifeve.com/2013/07/">2013年七月</a>&nbsp;(26)</li>
	<li><a href="http://ifeve.com/2013/06/">2013年六月</a>&nbsp;(16)</li>
	<li><a href="http://ifeve.com/2013/05/">2013年五月</a>&nbsp;(9)</li>
	<li><a href="http://ifeve.com/2013/04/">2013年四月</a>&nbsp;(17)</li>
	<li><a href="http://ifeve.com/2013/03/">2013年三月</a>&nbsp;(41)</li>
	<li><a href="http://ifeve.com/2013/02/">2013年二月</a>&nbsp;(25)</li>
	<li><a href="http://ifeve.com/2013/01/">2013年一月</a>&nbsp;(57)</li>
	<li><a href="http://ifeve.com/2012/12/">2012年十二月</a>&nbsp;(9)</li>
	<li><a href="http://ifeve.com/2012/10/">2012年十月</a>&nbsp;(1)</li>
	<li><a href="http://ifeve.com/2012/08/">2012年八月</a>&nbsp;(1)</li>
		</ul>
</div>
 </div>
 <div id="side_right">
  <div class="side_box_short widget_links" id="linkcat-2">
<h3 class="side_title">友情链接</h3>

	<ul class="xoxo blogroll">
<li><a href="http://coolshell.cn/" rel="co-worker" onclick="javascript:window.open(&#39;http://coolshell.cn/&#39;); return false;">coolshell</a></li>
<li><a href="http://blog.91gaoqing.com/" onclick="javascript:window.open(&#39;http://blog.91gaoqing.com/&#39;); return false;">Programer. 大猫</a></li>
<li><a href="http://hugozhu.myalert.info/" rel="co-worker" onclick="javascript:window.open(&#39;http://hugozhu.myalert.info/&#39;); return false;">一粟的博客</a></li>
<li><a href="http://bj.liepin.com/" onclick="javascript:window.open(&#39;http://bj.liepin.com/&#39;); return false;">北京猎聘网</a></li>
<li><a href="http://blog.csdn.net/cutesource/" rel="acquaintance co-worker" onclick="javascript:window.open(&#39;http://blog.csdn.net/cutesource/&#39;); return false;">志俊的博客</a></li>
<li><a href="http://www.zuidaima.com/" onclick="javascript:window.open(&#39;http://www.zuidaima.com/&#39;); return false;">最代码</a></li>
<li><a href="http://diandianzhe.com/" onclick="javascript:window.open(&#39;http://diandianzhe.com/&#39;); return false;">点点折</a></li>
<li><a href="http://www.liuinsect.com/" onclick="javascript:window.open(&#39;http://www.liuinsect.com/&#39;); return false;">码梦为生</a></li>
<li><a href="http://namiao.org/" rel="acquaintance co-worker" onclick="javascript:window.open(&#39;http://namiao.org/&#39;); return false;">纳秒</a></li>
<li><a href="http://www.656463.com/" onclick="javascript:window.open(&#39;http://www.656463.com/&#39;); return false;">领悟书生</a></li>

	</ul>
</div>

<div class="side_box_short widget_categories" id="categories-2">
<h3 class="side_title">分类目录</h3>
		<ul>
	<li class="cat-item cat-item-387"><a href="http://ifeve.com/category/framework/akka/">akka</a> (18)
</li>
	<li class="cat-item cat-item-415"><a href="http://ifeve.com/category/android/">Android</a> (3)
</li>
	<li class="cat-item cat-item-289"><a href="http://ifeve.com/category/c/">C++</a> (11)
</li>
	<li class="cat-item cat-item-366"><a href="http://ifeve.com/category/cpu-2/">CPU</a> (2)
</li>
	<li class="cat-item cat-item-73"><a href="http://ifeve.com/category/framework/">Framework</a> (45)
</li>
	<li class="cat-item cat-item-458"><a href="http://ifeve.com/category/go/">GO</a> (6)
</li>
	<li class="cat-item cat-item-617"><a href="http://ifeve.com/category/groovy/">groovy</a> (6)
</li>
	<li class="cat-item cat-item-310"><a href="http://ifeve.com/category/guava-2/">guava</a> (22)
</li>
	<li class="cat-item cat-item-69"><a href="http://ifeve.com/category/java/">JAVA</a> (372)
</li>
	<li class="cat-item cat-item-127"><a href="http://ifeve.com/category/jvm/">JVM</a> (34)
</li>
	<li class="cat-item cat-item-300"><a href="http://ifeve.com/category/linux/">linux</a> (7)
</li>
	<li class="cat-item cat-item-280"><a href="http://ifeve.com/category/netty/">Netty</a> (22)
</li>
	<li class="cat-item cat-item-166"><a href="http://ifeve.com/category/scala/">Scala</a> (9)
</li>
	<li class="cat-item cat-item-388"><a href="http://ifeve.com/category/storm/">storm</a> (42)
</li>
	<li class="cat-item cat-item-620"><a href="http://ifeve.com/category/thinking/">thinking</a> (1)
</li>
	<li class="cat-item cat-item-485"><a href="http://ifeve.com/category/velocity/">Velocity</a> (6)
</li>
	<li class="cat-item cat-item-279"><a href="http://ifeve.com/category/web/">Web</a> (13)
</li>
	<li class="cat-item cat-item-148"><a href="http://ifeve.com/category/notice/">公告</a> (5)
</li>
	<li class="cat-item cat-item-378"><a href="http://ifeve.com/category/bigdata/">大数据</a> (22)
</li>
	<li class="cat-item cat-item-138"><a href="http://ifeve.com/category/%e5%a5%bd%e6%96%87%e6%8e%a8%e8%8d%90/">好文推荐</a> (26)
</li>
	<li class="cat-item cat-item-244"><a href="http://ifeve.com/category/%e5%b9%b6%e5%8f%91%e4%b9%a6%e7%b1%8d/">并发书籍</a> (95)
</li>
	<li class="cat-item cat-item-29"><a href="http://ifeve.com/category/concurrency-translation/" title="发布国外并发编程相关文献译文。">并发译文</a> (359)
</li>
	<li class="cat-item cat-item-7"><a href="http://ifeve.com/category/ask/" title="可以在这里发表并发编程的问题。如何发表？用QQ登陆，然后点击“新建文章”，管理员审核后就可以发表。">技术问答</a> (11)
</li>
	<li class="cat-item cat-item-147"><a href="http://ifeve.com/category/%e6%95%8f%e6%8d%b7%e7%ae%a1%e7%90%86/">敏捷管理</a> (5)
</li>
	<li class="cat-item cat-item-1"><a href="http://ifeve.com/category/talk-concurrent/">本站原创</a> (72)
</li>
	<li class="cat-item cat-item-367"><a href="http://ifeve.com/category/%e6%9e%b6%e6%9e%84/">架构</a> (19)
</li>
	<li class="cat-item cat-item-305"><a href="http://ifeve.com/category/%e6%b4%bb%e5%8a%a8/">活动</a> (7)
</li>
	<li class="cat-item cat-item-414"><a href="http://ifeve.com/category/%e7%bd%91%e7%bb%9c/">网络</a> (3)
</li>
		</ul>
</div>
 </div>
</div>
<div id="side_bottom">
 <div class="side_box widget_text" id="text-15">
			<div class="textwidget"><script async="" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/adsbygoogle.js"></script>
<!-- 摩天大楼 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-9394337417063147" data-ad-slot="6358703113" data-adsbygoogle-status="done"><ins id="aswift_4_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><ins id="aswift_4_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><iframe width="300" height="600" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_4" name="aswift_4" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- CNZZ -->
<script src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/stat.php" language="JavaScript"></script><script src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=5003572" title="站长统计" onclick="javascript:window.open(&#39;http://www.cnzz.com/stat/website.php?web_id=5003572&#39;); return false;"><img border="0" hspace="0" vspace="0" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/pic.gif"></a>

感谢<a href="https://www.upyun.com/index.html" onclick="javascript:window.open(&#39;https://www.upyun.com/index.html&#39;); return false;">又拍云</a>为本站提供服务器和图片服务。</div>
		</div>
</div>

  </div>
  
  <div id="footer">

<ul id="copyright">
    <li>版权所有 ©&nbsp; <a href="http://ifeve.com/">并发编程网 – ifeve.com</a></li>
    <li>ICP号: <a href="http://www.miibeian.gov.cn/" onclick="javascript:window.open(&#39;http://www.miibeian.gov.cn/&#39;); return false;">浙ICP备12046809号</a></li>
<li class="last"><script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/tongji.js"></script><img src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/tongji.do" border="0" width="1" height="1"><a href="http://tongji.linezing.com/report.html?unit_id=3067707" onclick="javascript:window.open(&#39;http://tongji.linezing.com/report.html?unit_id=3067707&#39;); return false;">量子统计</a><noscript>&lt;a href="http://www.linezing.com"&gt;&lt;img src="http://img.tongji.linezing.com/3067707/tongji.gif"/&gt;&lt;/a&gt;</noscript></li>
   </ul>
 </div>
 </div><!-- END #main_content -->

  <p id="return_top"><a href="http://ifeve.com/concurrentlinkedqueue/#header">return top</a></p>
 
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/shCore.js"></script>
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/shBrushJava.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shCore.css?ver=2.1.364";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shThemeEclipse.css?ver=2.1.364";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.clipboardSwf = 'http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf';
	SyntaxHighlighter.config.strings.expandSource = 'show source';
	SyntaxHighlighter.config.strings.viewSource = '查看源代码';
	SyntaxHighlighter.config.strings.copyToClipboard = '复制到剪贴板';
	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = '代码现在在你的剪贴板';
	SyntaxHighlighter.config.strings.print = '打印';
	SyntaxHighlighter.config.strings.help = '帮助';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = '无法找到Brush：';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush不能设置 html-script选项';
	SyntaxHighlighter.defaults['pad-line-numbers'] = true;
	SyntaxHighlighter.all();
</script>
<link rel="stylesheet" id="yarppRelatedCss-css" href="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/related.css" type="text/css" media="all">
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var ratingsL10n = {"plugin_url":"http:\/\/ifeve.com\/wp-content\/plugins\/wp-postratings","ajax_url":"http:\/\/ifeve.com\/wp-admin\/admin-ajax.php","text_wait":"Please rate only 1 post at a time.","image":"stars_crystal","image_ext":"gif","max":"5","show_loading":"1","show_fading":"1","custom":"0"};
var ratings_mouseover_image=new Image();ratings_mouseover_image.src=ratingsL10n.plugin_url+"/images/"+ratingsL10n.image+"/rating_over."+ratingsL10n.image_ext;;
/* ]]> */
</script>
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/postratings-js.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/ifeve.com\/wp-admin\/admin-ajax.php","post_id":"1541"};
/* ]]> */
</script>
<script type="text/javascript" src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/postviews-cache.js"></script>



<script src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jquery.min.js"></script>

<script src="./聊聊并发（六）ConcurrentLinkedQueue的实现原理分析_files/jquery.bpopup-0.8.0.min.js"></script>


<!--
<script type="text/javascript">

;(function($) {

    $(function() {

        var url=document.referrer;

        if ( url && url.search("http://")>-1) {

            var refurl =  url.match(/:\/\/(.[^/]+)/)[1];

            if(refurl.indexOf("baidu.com")>-1){

                $('#nobaidu_dlg').bPopup();

            }

        }

    });



})(jQuery);

</script>




<div id="nobaidu_dlg" style="background-color:#fff; border-radius:15px;color:#000;display:none;padding:20px;min-width:450px;min-height:180px;">

    <span class="bClose" style="cursor:pointer; position:absolute; right:10px;top:5px;">x<span/>

    <img src="http://coolshell.cn//wp-content/themes/inove/img/nobaidu.jpg" align="left">

     <p style="margin-left:200px;margin-top: 20px; line-height: 30px;">

     检测到你还在使用百度这个搜索引擎，<br/>

     做为一个程序员，这是一种自暴自弃！<br/>

     <br/>

     </p>

     <p align="center" style="margin-top:20px;">

     <b><a href="http://coolshell.cn/articles/7186.html">作环保的程序员，从不用百度开始！</a></b>

     </p>

</div>
-->

<!-- Dynamic page generated in 1.220 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2015-10-08 08:58:00 -->
</body></html>